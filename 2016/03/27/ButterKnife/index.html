<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="æå…¨æ°‘çš„ä¸ªäººåšå®¢"><title>ButterKnife æºç åˆ†æ | èœ—ç‰›å£³</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-65882749-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">ButterKnife æºç åˆ†æ</h1><a id="logo" href="/.">èœ—ç‰›å£³</a><p class="description">è®¡ç®—æœºåªæœ‰ 0 å’Œ 1 ï¼Œä½†ä¸–ç•Œæ˜¯è¿ç»­çš„</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">ButterKnife æºç åˆ†æ</h1><div class="post-meta">Mar 27, 2016<span> | </span><span class="category"><a href="/categories/Android/">Android</a></span></div><div class="post-content"><h1 id="åŸºæœ¬ä»‹ç»"><a href="#åŸºæœ¬ä»‹ç»" class="headerlink" title="åŸºæœ¬ä»‹ç»"></a>åŸºæœ¬ä»‹ç»</h1><div align="center"><img src="http://7xktd8.com1.z0.glb.clouddn.com/logo_butterknife.png" width="188" alt="ButterKnife Logo"></div>

<p><strong>ButterKnife</strong> æ˜¯ä¸€ä¸ªæ³¨è§£æ¡†æ¶ï¼Œé¡¹ç›®åœ°å€: <a href="http://jakewharton.github.io/butterknife/" target="_blank" rel="noopener">ButterKnife</a> ã€‚ ç®€å•ä½¿ç”¨ğŸŒ°å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Bind</span>(R.id.title) TextView title;</span><br><span class="line">	<span class="meta">@Bind</span>(R.id.subtitle) TextView subtitle;</span><br><span class="line">	<span class="meta">@Bind</span>(R.id.footer) TextView footer;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">		setContentView(R.layout.simple_activity);</span><br><span class="line">		ButterKnife.bind(<span class="keyword">this</span>);</span><br><span class="line">		<span class="comment">// TODO Use fields...</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@OnClick</span>(R.id.footer)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">submit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  		<span class="comment">// TODO submit data to server...</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šè¿™æ®µä»£ç å¯ä»¥ä»£æ›¿ä»¥ä¸‹è¿™æ®µä»£ç :<a id="more"></a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(ExampleActivity activity)</span> </span>&#123;</span><br><span class="line">	activity.subtitle = (android.widget.TextView) activity.findViewById(<span class="number">2130968578</span>);</span><br><span class="line">	activity.footer = (android.widget.TextView) activity.findViewById(<span class="number">2130968579</span>);</span><br><span class="line">	activity.title = (android.widget.TextView) activity.findViewById(<span class="number">2130968577</span>);</span><br><span class="line">	</span><br><span class="line">	activity.footer..setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">			submit();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œä½¿ç”¨ButterKnifeåå¯ä»¥ä¸ç”¨å†å»å†™<code>findViewById</code>ã€<code>setOnClickListener</code>è¿™æ ·é‡å¤ç¹çä»£ç ï¼Œé€šè¿‡<code>@Bind</code>ã€<code>@OnClick</code>æ³¨è§£å°±å¯ä»¥è¾¾åˆ°æ•ˆæœï¼Œä»£ç ç®€æ´ä¸å°‘ã€‚</p>
<p>æ›´å¤šçš„ä¾‹å­å’ŒåŠŸèƒ½å¯ä»¥å‚è§<a href="http://jakewharton.github.io/butterknife/" target="_blank" rel="noopener">å®˜ç½‘ç¤ºä¾‹</a>ã€‚</p>
<p>æœ¬æ–‡é‡ç‚¹åˆ†æä¸¤ä¸ªå†…å®¹ï¼š</p>
<ol>
<li>ButterKnifeçš„æ³¨è§£å®šä¹‰æ–¹å¼ï¼›</li>
<li>ButterKnifeæ˜¯å¦‚ä½•è¿ç”¨ç¼–è¯‘æ—¶æ³¨è§£æ¥æé«˜æ•ˆç‡çš„ï¼ˆåœ¨Androidä¸Šï¼Œåå°„çš„æ•ˆç‡è¾ƒä½ï¼‰ï¼› </li>
</ol>
<h1 id="çŸ¥è¯†å‚¨å¤‡"><a href="#çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="çŸ¥è¯†å‚¨å¤‡"></a>çŸ¥è¯†å‚¨å¤‡</h1><p>ç ”ç©¶ButterKnifeè¦å…·å¤‡ä¸€å®šçš„æ³¨è§£çŸ¥è¯†ï¼ŒCodeKKä¸Šæœ‰ç¯‡æ–‡ç« æ¨èé˜…è¯»: <a href="http://a.codekk.com/detail/Android/Trinea/%E5%85%AC%E5%85%B1%E6%8A%80%E6%9C%AF%E7%82%B9%E4%B9%8B%20Java%20%E6%B3%A8%E8%A7%A3%20Annotation" target="_blank" rel="noopener">ã€Šå…¬å…±æŠ€æœ¯ç‚¹ä¹‹ Java æ³¨è§£ Annotationã€‹</a>ã€‚</p>
<p>å…³äºè¿è¡Œæ—¶æ³¨è§£çš„å¼€å‘ï¼Œå¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« :<a href="http://www.race604.com/annotation-processing/" target="_blank" rel="noopener">Javaæ³¨è§£å¤„ç†å™¨</a>ã€‚ButterKnifeä½¿ç”¨çš„æ˜¯<code>com.google.auto.service:auto-service</code>åŒ…ï¼Œé€šè¿‡å…¶<code>AutoService</code>æ³¨è§£æ¥å®ç°ç¼–è¯‘æ—¶æ³¨è§£çš„å¼€å‘ã€‚</p>
<p>å¦å¤–ä¹Ÿå¯ä»¥å…³æ³¨ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®: <a href="https://bitbucket.org/hvisser/android-apt" target="_blank" rel="noopener">android-apt</a>ã€‚</p>
<h1 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h1><p>å¦‚ä¸‹æ˜¯ButterKnifeçš„é¡¹ç›®ç»“æ„:</p>
<div align="center"><img src="http://7xktd8.com1.z0.glb.clouddn.com/ButterKnifeé¡¹ç›®.png" width="250" alt="ButterKnifeé¡¹ç›®"></div>

<p>ButterKnifeé¡¹ç›®åˆ†ä¸ºå››ä¸ªModule: Module butterknife-annotationsä¸­å®šä¹‰çš„æ˜¯ButterKnifeæ‰€æ”¯æŒçš„æ³¨è§£ï¼Œbutterknife-compilerä¸­ä¸»è¦æ˜¯ç¼–è¯‘æ—¶æ³¨è§£Processorã€‚butterknife-sampleåˆ™æ˜¯ä¸€ä¸ªä½¿ç”¨ä¾‹å­ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»¬å°±æ¥é€æ­¥åˆ†ææ•´ä¸ªæ³¨è§£æ¡†æ¶çš„å®ç°ã€‚</p>
<h1 id="æ³¨è§£å®šä¹‰è§£æ"><a href="#æ³¨è§£å®šä¹‰è§£æ" class="headerlink" title="æ³¨è§£å®šä¹‰è§£æ"></a>æ³¨è§£å®šä¹‰è§£æ</h1><p>ButterKnifeæ”¯æŒçš„æ³¨è§£ä¸»è¦åˆ†ä¸ºå››ç±»:</p>
<ol>
<li>èµ„æºç»‘å®šã€‚é€šè¿‡Idå¼•ç”¨Arrayã€Bitmapã€Boolã€Colorã€Dimenã€Drawableã€Intã€Stringç­‰å‡ ç±»èµ„æºï¼›</li>
<li>äº‹ä»¶ç»‘å®šã€‚åŒ…æ‹¬onCheckedChangedã€onClickã€onItemClickã€onItemLongClickç­‰å‡ ç§äº‹ä»¶ç›‘å¬ï¼›</li>
<li>è§†å›¾ç»‘å®šã€‚é€šè¿‡idå®ä¾‹åŒ–xmlä¸­çš„Viewï¼›</li>
<li>Markæ³¨è§£ã€‚Unbinderå’ŒOptionalï¼›</li>
</ol>
<h2 id="èµ„æºç»‘å®šæ³¨è§£å®šä¹‰"><a href="#èµ„æºç»‘å®šæ³¨è§£å®šä¹‰" class="headerlink" title="èµ„æºç»‘å®šæ³¨è§£å®šä¹‰"></a>èµ„æºç»‘å®šæ³¨è§£å®šä¹‰</h2><p>è¿™ç±»æ³¨è§£éƒ½ä»¥<code>BindXXX</code>çš„å½¢å¼æ¥å‘½åï¼Œç”±äºèµ„æºæ³¨è§£éƒ½åªéœ€è¦æŒ‡å®šèµ„æºçš„idï¼Œå› æ­¤å®šä¹‰çš„å½¢å¼éå¸¸ä¸€è‡´ã€‚ä¸‹é¢ä»¥Stringèµ„æºä¸ºä¾‹ï¼Œå±•ç¤ºä¸€ä¸‹å®šä¹‰å†…å®¹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Bind a field to the specified string resource ID.</span></span><br><span class="line"><span class="comment"> * &lt;pre&gt;&lt;code&gt;</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@literal</span> @&#125;BindString(R.string.username_error) String usernameErrorText;</span></span><br><span class="line"><span class="comment"> * &lt;/code&gt;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Retention</span>(CLASS) <span class="meta">@Target</span>(FIELD)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> BindString &#123;</span><br><span class="line">	<span class="comment">/** String resource ID to which the field will be bound. */</span></span><br><span class="line">	<span class="meta">@StringRes</span> <span class="function"><span class="keyword">int</span> <span class="title">value</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œè¿˜ç”¨åˆ°äº†Androidæä¾›çš„èµ„æºæ³¨è§£ï¼Œä»¥ä¿è¯è¿”å›çš„Idç¬¦åˆç‰¹å®šçš„èµ„æºã€‚æ³¨è§£æ˜¯ç¼–è¯‘æ—¶æ³¨è§£(CLASS)ï¼Œé€‚ç”¨äºå±æ€§(FIELD)ã€‚</p>
<h2 id="äº‹ä»¶ç»‘å®šæ³¨è§£"><a href="#äº‹ä»¶ç»‘å®šæ³¨è§£" class="headerlink" title="äº‹ä»¶ç»‘å®šæ³¨è§£"></a>äº‹ä»¶ç»‘å®šæ³¨è§£</h2><p>äº‹ä»¶ç»‘å®šæ³¨è§£æ¯”è¾ƒå¤æ‚ï¼Œä¸»è¦æ˜¯å› ä¸ºä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢:</p>
<ol>
<li>ä¸ºViewæ·»åŠ ç›‘å¬çš„æ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ¯”å¦‚<code>setOnClickListener</code>ã€<code>addTextChangedListener</code>ã€<code>setOnFocusChangeListener</code>ç­‰ï¼Œæ–¹æ³•åå­—æœ¬èº«ä¸ä¸€è‡´ï¼Œä¸”æ— è§„å¾‹å¯è¨€ï¼›</li>
<li>è¿™äº›æ–¹æ³•åªèƒ½ç»‘å®šåœ¨ç‰¹å®šçš„Viewä¸Šé¢ï¼›</li>
<li>ç›‘å¬éœ€è¦å®ç°çš„æ–¹æ³•æœ‰å¾ˆå¤§çš„å·®åˆ«ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ<code>OnLongClickListener</code>å’Œ<code>TextWatcher</code>éœ€è¦å®ç°çš„æ–¹æ³•çš„åŒºåˆ«ï¼›</li>
</ol>
<p>å› æ­¤åœ¨ButterKnifeå†…éƒ¨ä¸“é—¨ä¸ºæ­¤å»ºç«‹ä¸¤ä¸ªæ³¨è§£:<code>ListenerClass</code>å’Œ<code>ListenerMethod</code>ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯ButterKnifeæ”¯æŒäº‹ä»¶ç»‘å®šæ³¨è§£çš„å…ƒæ³¨è§£ï¼‰ã€‚</p>
<h3 id="äº‹ä»¶å…ƒæ³¨è§£"><a href="#äº‹ä»¶å…ƒæ³¨è§£" class="headerlink" title="äº‹ä»¶å…ƒæ³¨è§£"></a>äº‹ä»¶å…ƒæ³¨è§£</h3><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹<code>ListenerMethod</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RUNTIME) <span class="meta">@Target</span>(FIELD)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ListenerMethod &#123;</span><br><span class="line">	<span class="comment">/** Name of the listener method for which this annotation applies. */</span></span><br><span class="line">	<span class="function">String <span class="title">name</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** List of method parameters. If the type is not a primitive it must be fully-qualified. */</span></span><br><span class="line">	String[] parameters() <span class="keyword">default</span> &#123; &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Primitive or fully-qualified return type of the listener method. May also be &#123;<span class="doctag">@code</span> void&#125;. */</span></span><br><span class="line">	<span class="function">String <span class="title">returnType</span><span class="params">()</span> <span class="keyword">default</span> "<span class="keyword">void</span>"</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** If &#123;<span class="doctag">@link</span> #returnType()&#125; is not &#123;<span class="doctag">@code</span> void&#125; this value is returned when no binding exists. */</span></span><br><span class="line">	<span class="function">String <span class="title">defaultReturn</span><span class="params">()</span> <span class="keyword">default</span> "<span class="keyword">null</span>"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ³¨è§£ä¸»è¦æ˜¯å®šä¹‰ä¸€ä¸ªæ–¹æ³•çš„ç­¾å(æ–¹æ³•åå­—ã€æ–¹æ³•çš„å‚æ•°ã€æ–¹æ³•çš„è¿”å›ç±»å‹)ä»¥åŠé»˜è®¤è¿”å›å€¼ã€‚</p>
<p>å†æ¥çœ‹<code>ListenerClass</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Retention</span>(RUNTIME) <span class="meta">@Target</span>(ANNOTATION_TYPE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ListenerClass &#123;</span><br><span class="line">	<span class="function">String <span class="title">targetType</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Name of the setter method on the &#123;<span class="doctag">@link</span> #targetType() target type&#125; for the listener. */</span></span><br><span class="line">	<span class="function">String <span class="title">setter</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Fully-qualified class name of the listener type. */</span></span><br><span class="line">	<span class="function">String <span class="title">type</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Enum which declares the listener callback methods. Mutually exclusive to &#123;<span class="doctag">@link</span> #method()&#125;. */</span></span><br><span class="line">	Class&lt;? extends Enum&lt;?&gt;&gt; callbacks() <span class="keyword">default</span> NONE.class;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Method data for single-method listener callbacks. Mutually exclusive with &#123;<span class="doctag">@link</span> #callbacks()&#125;</span></span><br><span class="line"><span class="comment">    * and an error to specify more than one value.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">	ListenerMethod[] method() <span class="keyword">default</span> &#123; &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Default value for &#123;<span class="doctag">@link</span> #callbacks()&#125;. */</span></span><br><span class="line">	<span class="keyword">enum</span> NONE &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ³¨è§£ä¸»è¦å®šä¹‰å¦‚ä¸‹å†…å®¹:</p>
<ol>
<li><strong>setter():</strong> ç›‘å¬çš„è®¾ç½®æ–¹æ³•å…¨ç§°ï¼›</li>
<li><strong>type():</strong> ç›‘å¬ç±»çš„ç±»åå…¨ç§°ï¼›</li>
<li><strong>method():</strong> ç›‘å¬ç±»ä¸­æœ‰å“ªäº›æ–¹æ³•ï¼›</li>
<li><strong>callback():</strong> å½“ä¸€ä¸ªç›‘å¬æœ‰å¤šä¸ªå›è°ƒæ—¶ï¼ŒæŒ‡å®šå½“å‰æ–¹æ³•åœ¨å“ªä¸ªå›è°ƒä¸­è°ƒç”¨ï¼Œåé¢æœ‰è¯¦ç»†é˜è¿°ï¼›</li>
</ol>
<p>æ³¨æ„ï¼Œè¿™ä¸¤ä¸ªæ³¨è§£éƒ½æ˜¯ç”¨æ¥ä¿®é¥°æ³¨è§£çš„ï¼šå¯ä»¥çœ‹åˆ°<code>@Target</code>éƒ½æ˜¯<code>ANNOTATION_TYPE</code>ç±»å‹çš„ã€‚</p>
<h3 id="äº‹ä»¶æ³¨è§£"><a href="#äº‹ä»¶æ³¨è§£" class="headerlink" title="äº‹ä»¶æ³¨è§£"></a>äº‹ä»¶æ³¨è§£</h3><p>ç”±äºäº‹ä»¶çš„å¤æ‚æ€§ï¼Œæ³¨è§£å®šä¹‰æœ¬èº«å·®è·æ¯”è¾ƒå¤§ï¼Œå…ˆçœ‹ä¸€ä¸ªç®€å•çš„:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(CLASS)</span><br><span class="line"><span class="meta">@ListenerClass</span>(</span><br><span class="line">    targetType = <span class="string">"android.widget.CompoundButton"</span>,</span><br><span class="line">    setter = <span class="string">"setOnCheckedChangeListener"</span>,</span><br><span class="line">    type = <span class="string">"android.widget.CompoundButton.OnCheckedChangeListener"</span>,</span><br><span class="line">    method = <span class="meta">@ListenerMethod</span>(</span><br><span class="line">        name = <span class="string">"onCheckedChanged"</span>,</span><br><span class="line">        parameters = &#123;</span><br><span class="line">            <span class="string">"android.widget.CompoundButton"</span>,</span><br><span class="line">            <span class="string">"boolean"</span></span><br><span class="line">        &#125;</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> OnCheckedChanged &#123;</span><br><span class="line">	<span class="comment">/** View IDs to which the method will be bound. */</span></span><br><span class="line">	<span class="meta">@IdRes</span> <span class="keyword">int</span>[] value() <span class="keyword">default</span> &#123; View.NO_ID &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆï¼Œè¯¥æ³¨è§£åŒæ ·æ˜¯ç¼–è¯‘æ—¶æ³¨è§£ï¼Œå¹¶ä¸”æ˜¯ç”¨äºä¿®é¥°ä¸€ä¸ªæ–¹æ³•çš„ã€‚<br>å…¶æ¬¡ï¼Œä½¿ç”¨â€œå…ƒæ³¨è§£â€ä¿®é¥°è¯¥æ³¨è§£ï¼šè¯¥æ³¨è§£æ˜¯ç”¨äºä¸ºComPoundButtoné€šè¿‡<code>setOnCheckedChangeListener</code>æ·»åŠ <code>OnCheckedChangeListener</code>ç›‘å¬çš„ï¼Œè¯¥ç›‘å¬æœ‰ä¸€ä¸ªéœ€è¦å®ç°çš„æ–¹æ³•<code>onCheckedChanged</code>ï¼Œè¯¥æ–¹æ³•ä¼ å…¥ä¸€ä¸ªCompoundButtonå¯¹è±¡å’Œå¸ƒå°”å€¼ä½œä¸ºå‚æ•°ã€‚</p>
<p>æœ€åæˆ‘ä»¬å…³æ³¨ä¸€ä¸‹è¿™ä¸ªæ³¨è§£æœ¬èº«ï¼šå®ƒåªéœ€è¦è¿”å›è®¾ç½®ä¸€ç»„idå³å¯ï¼Œé»˜è®¤è¿”å›çš„æ˜¯<code>View.NO_ID</code>ã€‚</p>
<p>è¿™æ ·å°±å®Œæˆäº†ä¸€ä¸ªäº‹ä»¶æ³¨è§£çš„å®šä¹‰ã€‚è¿™æ ·çœ‹ä¸Šå»å¾ˆæŠ½è±¡ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸ªå®˜ç½‘å¯¹<code>OnClick</code>æ³¨è§£çš„ä½¿ç”¨ä¾‹å­å°±æ¸…æ¥šäº†:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OnClick</span>(&#123; R.id.door1, R.id.door2, R.id.door3 &#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pickDoor</span><span class="params">(DoorView door)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (door.hasPrizeBehind()) &#123;</span><br><span class="line">		Toast.makeText(<span class="keyword">this</span>, <span class="string">"You win!"</span>, LENGTH_SHORT).show();</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		Toast.makeText(<span class="keyword">this</span>, <span class="string">"Try again"</span>, LENGTH_SHORT).show();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šï¼Œå°±æ˜¯ä¸ºä¸‰ä¸ªdoor Viewæ·»åŠ <code>onClickListener</code>ç›‘å¬ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœä¸€ä¸ªç›‘å¬æœ‰å¤šä¸ªæ–¹æ³•éœ€è¦å›è°ƒï¼Œåˆåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæ¯”å¦‚ViewPagerçš„<code>OnPageChangeListener</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">viewPager.setOnPageChangeListener(<span class="keyword">new</span> ViewPager.OnPageChangeListener() &#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrolled</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">float</span> v, <span class="keyword">int</span> i1)</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageSelected</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrollStateChanged</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¦‚æœåƒ<code>@onClick</code>é‚£æ ·ç»‘å®šï¼Œæˆ‘æ€ä¹ˆçŸ¥é“ç»‘å®šçš„æ˜¯å“ªä¸ªæ–¹æ³•å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜¯åœ¨å“ªä¸ªå›è°ƒé‡Œé¢æ‰§è¡Œè¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿè¿™ä¸ªæ˜¯é€šè¿‡<code>callback</code>æ¥å®ç°çš„ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹<code>@OnPageChange</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target</span>(METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(CLASS)</span><br><span class="line"><span class="meta">@ListenerClass</span>(</span><br><span class="line">    targetType = <span class="string">"android.support.v4.view.ViewPager"</span>,</span><br><span class="line">    setter = <span class="string">"setOnPageChangeListener"</span>,</span><br><span class="line">    type = <span class="string">"android.support.v4.view.ViewPager.OnPageChangeListener"</span>,</span><br><span class="line">    callbacks = OnPageChange.Callback.class</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> OnPageChange &#123;</span><br><span class="line">	<span class="comment">/** View IDs to which the method will be bound. */</span></span><br><span class="line">	<span class="meta">@IdRes</span> <span class="keyword">int</span>[] value() <span class="keyword">default</span> &#123; View.NO_ID &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** Listener callback to which the method will be bound. */</span></span><br><span class="line">	<span class="function">Callback <span class="title">callback</span><span class="params">()</span> <span class="keyword">default</span> Callback.PAGE_SELECTED</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/** &#123;<span class="doctag">@code</span> ViewPager.OnPageChangeListener&#125; callback methods. */</span></span><br><span class="line">	<span class="keyword">enum</span> Callback &#123;</span><br><span class="line">		<span class="comment">/** &#123;<span class="doctag">@code</span> onPageSelected(int)&#125; */</span></span><br><span class="line">		<span class="meta">@ListenerMethod</span>(</span><br><span class="line">			name = <span class="string">"onPageSelected"</span>,</span><br><span class="line">			parameters = <span class="string">"int"</span></span><br><span class="line">		PAGE_SELECTED,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/** &#123;<span class="doctag">@code</span> onPageScrolled(int, float, int)&#125; */</span></span><br><span class="line">		<span class="meta">@ListenerMethod</span>(</span><br><span class="line">			name = <span class="string">"onPageScrolled"</span>,</span><br><span class="line">			parameters = &#123;</span><br><span class="line">				<span class="string">"int"</span>,</span><br><span class="line">				<span class="string">"float"</span>,</span><br><span class="line">				<span class="string">"int"</span></span><br><span class="line">			&#125;</span><br><span class="line">		)</span><br><span class="line">		PAGE_SCROLLED,</span><br><span class="line"></span><br><span class="line">		<span class="comment">/** &#123;<span class="doctag">@code</span> onPageScrollStateChanged(int)&#125; */</span></span><br><span class="line">    	<span class="meta">@ListenerMethod</span>(</span><br><span class="line">        	name = <span class="string">"onPageScrollStateChanged"</span>,</span><br><span class="line">        	parameters = <span class="string">"int"</span></span><br><span class="line">    	)</span><br><span class="line">    	PAGE_SCROLL_STATE_CHANGED,</span><br><span class="line">  	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>callbackå…¶å®æ˜¯ä¸ªæšä¸¾å€¼ï¼Œæ˜¯ä¸€ç»„ListenerMethodï¼Œæ˜ å°„åˆ°ç›‘å¬ç±»çš„è‹¥å¹²ä¸ªæ–¹æ³•ï¼Œ<code>@OnPageChange</code>æ³¨è§£å°±å®šä¹‰äº†ä¸‰ç»„ï¼Œcallbacké»˜è®¤æ˜¯<code>Callback.PAGE_SELECTED</code>ï¼Œè¿™ä¸ªå€¼ä»£è¡¨çš„æ–¹æ³•æ˜¯<code>onPageSelected</code>ï¼Œå³å¦‚æœæŒ‰ç…§ä¸‹é¢çš„ç”¨æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OnPageChange</span>(R.id.example_pager) <span class="function"><span class="keyword">void</span> <span class="title">onPageSelected</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">	Toast.makeText(<span class="keyword">this</span>, <span class="string">"Selected "</span> + position + <span class="string">"!"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå°±æ˜¯å½“<code>onPageSelected</code>å›è°ƒæ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è°ƒç”¨ã€‚å¦‚æœæˆ‘æƒ³ç»‘å®šåˆ°å¦å¤–ä¸€ä¸ªå›è°ƒæ¥å£é‡Œé¢å»ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿå¯ä»¥å¦‚ä¸‹ä½¿ç”¨:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@OnPageChange</span>(value = R.id.example_pager, callback = PAGE_SCROLL_STATE_CHANGED)</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">onPageStateChanged</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line">	Toast.makeText(<span class="keyword">this</span>, <span class="string">"State changed: "</span> + state + <span class="string">"!"</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å¯ä»¥åœ¨<code>onPageScrollStateChanged</code>å›è°ƒä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•äº†ã€‚</p>
<h2 id="è§†å›¾ç»‘å®šæ³¨è§£"><a href="#è§†å›¾ç»‘å®šæ³¨è§£" class="headerlink" title="è§†å›¾ç»‘å®šæ³¨è§£"></a>è§†å›¾ç»‘å®šæ³¨è§£</h2><p>å’Œèµ„æºç»‘å®šæ³¨è§£å¾ˆåƒï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Bind a field to the view for the specified ID. The view will automatically be cast to the field</span></span><br><span class="line"><span class="comment"> * type.</span></span><br><span class="line"><span class="comment"> * &lt;pre&gt;&lt;code&gt;</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@literal</span> @&#125;Bind(R.id.title) TextView title;</span></span><br><span class="line"><span class="comment"> * &lt;/code&gt;&lt;/pre&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Retention</span>(CLASS) <span class="meta">@Target</span>(FIELD)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Bind &#123;</span><br><span class="line">	<span class="comment">/** View ID to which the field will be bound. */</span></span><br><span class="line">	<span class="meta">@IdRes</span> <span class="keyword">int</span>[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åªä¸è¿‡è¿™é‡Œè¿”å›çš„æ˜¯ä¸€ä¸ªint[]æ•°ç»„ï¼Œå› ä¸º<code>@Bind</code>å®é™…æ”¯æŒå°†ä¸€ç»„idç»‘å®šåˆ°ä¸€ä¸ªæ•°ç»„æˆ–è€…Listå±æ€§ä¸Šã€‚</p>
<h2 id="å…¶ä½™æ³¨è§£"><a href="#å…¶ä½™æ³¨è§£" class="headerlink" title="å…¶ä½™æ³¨è§£"></a>å…¶ä½™æ³¨è§£</h2><ol>
<li><strong>Unbinder</strong> è¿™ä¸ªæ³¨è§£æ˜¯ä¸ºäº†ç»™ç±»ç”Ÿæˆä¸€ä¸ªUnbinderå®ä¾‹ï¼Œè¿™æ ·å¯ä»¥å°†ä¹‹å‰<code>bind</code>çš„å˜é‡å…¨éƒ¨è§£ç»‘ï¼Œåé¢æœ‰ä¾‹å­ï¼›</li>
<li><strong>Optional</strong> å¯é€‰é¡¹ï¼Œæœ‰æ—¶å€™æœ‰äº›Viewã€èµ„æºæ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥æœ‰äº›æ³¨å…¥å¿…é¡»å¯é€‰ï¼Œå¦åˆ™å°±ä¼šCrashï¼›</li>
</ol>
<h1 id="æ³¨è§£è§£æå¤§è‡´è¿‡ç¨‹"><a href="#æ³¨è§£è§£æå¤§è‡´è¿‡ç¨‹" class="headerlink" title="æ³¨è§£è§£æå¤§è‡´è¿‡ç¨‹"></a>æ³¨è§£è§£æå¤§è‡´è¿‡ç¨‹</h1><p>å®šä¹‰æ³¨è§£åªæ˜¯æ³¨è§£æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œä»£è¡¨ç€æ³¨è§£æ¡†æ¶æ‰€æ”¯æŒçš„åŠŸèƒ½ï¼Œè§£ææ³¨è§£æ˜¯æ³¨è§£æ¡†æ¶çš„å¦ä¸€ä¸ªæ ¸å¿ƒéƒ¨åˆ†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ButterKnifeæ˜¯å¦‚ä½•å®ç°ç¼–è¯‘æ—¶æ³¨è§£çš„ã€‚æˆ‘ä»¬å°±ä»ä½¿ç”¨çš„ä¾‹å­ä¸Šåˆ‡å…¥å¼€å§‹åˆ†ææ•´ä¸ªæ³¨è§£çš„è¿ä½œè¿‡ç¨‹ã€‚</p>
<h2 id="è¿è¡Œæ—¶è§£æ"><a href="#è¿è¡Œæ—¶è§£æ" class="headerlink" title="è¿è¡Œæ—¶è§£æ"></a>è¿è¡Œæ—¶è§£æ</h2><p>è¿è¡Œæ—¶è§£ææºäºButterKnifeçš„ä¸€è¡Œä»£ç :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ButterKnife.bind(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>
<p>åœ¨ä»»ä½•éœ€è¦ä½¿ç”¨ButterKnifeçš„ç±»ä¸­ï¼Œè¿™è¡Œä»£ç éƒ½éœ€è¦è°ƒç”¨ã€‚æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªæ–¹æ³•åšäº†ä»€ä¹ˆ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(@NonNull Activity target)</span> </span>&#123;</span><br><span class="line">    bind(target, target, Finder.ACTIVITY);</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(@NonNull Object target, @NonNull Object source, @NonNull Finder finder)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; targetClass = target.getClass();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug) Log.d(TAG, <span class="string">"Looking up view binder for "</span> + targetClass.getName());</span><br><span class="line">        ViewBinder&lt;Object&gt; viewBinder = findViewBinderForClass(targetClass);</span><br><span class="line">        viewBinder.bind(finder, target, source);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Unable to bind views for "</span> + targetClass.getName(), e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>bind()</code>æ–¹æ³•æœ‰å¾ˆå¤šé‡è½½æ–¹æ³•ï¼Œä½†æ˜¯æœ€ç»ˆéƒ½ä¼šè°ƒç”¨åˆ°æ–¹æ³•<code>bind(@NonNull Object target, @NonNull Object source, @NonNull Finder finder)</code>ã€‚è¿™ä¸ªæ–¹æ³•æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å…³æ³¨ä¸€ä¸‹ç¬¬ä¸‰ä¸ªå‚æ•°<code>Finder</code>ï¼Œè¿™ä¸ªå…¶å®æ˜¯ä¸€ä¸ªæšä¸¾ç±»ï¼Œç”¨äºç¼–è¯‘æ—¶ç”Ÿæˆçš„ä»£ç ä¸­ï¼Œéå¸¸é‡è¦ï¼ˆåé¢å°±å¯ä»¥è§åˆ°äº†ï¼‰ï¼Œå®ƒä¸»è¦çš„åŠŸèƒ½å¦‚ä¸‹:<br><strong>ä¸ºActivityã€Viewã€Dialogä¸‰ç§æƒ…æ™¯æä¾›Contextä»¥åŠfindViewByIdåŠŸèƒ½ï¼Œå¹¶è‡ªå¸¦å¼ºåˆ¶è½¬æ¢ã€‚</strong></p>
<p>è¿™ä¸ªæ–¹æ³•ä¼šå¯¹targetClassè¿›è¡Œè§£æï¼Œè°ƒç”¨çš„æ–¹æ³•æ˜¯<code>findViewBinderForClass()</code>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> Map&lt;Class&lt;?&gt;, ViewBinder&lt;Object&gt;&gt; BINDERS = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> ViewBinder&lt;Object&gt; NOP_VIEW_BINDER = <span class="keyword">new</span> ViewBinder&lt;Object&gt;() &#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NonNull</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> ViewBinder&lt;Object&gt; <span class="title">findViewBinderForClass</span><span class="params">(Class&lt;?&gt; cls)</span> <span class="keyword">throws</span> IllegalAccessException, InstantiationException </span>&#123;</span><br><span class="line">    ViewBinder&lt;Object&gt; viewBinder = BINDERS.get(cls);</span><br><span class="line">    <span class="keyword">if</span> (viewBinder != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug) Log.d(TAG, <span class="string">"HIT: Cached in view binder map."</span>);</span><br><span class="line">        <span class="keyword">return</span> viewBinder;</span><br><span class="line">    &#125;</span><br><span class="line">    String clsName = cls.getName();</span><br><span class="line">    <span class="keyword">if</span> (clsName.startsWith(<span class="string">"android."</span>) || clsName.startsWith(<span class="string">"java."</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug) Log.d(TAG, <span class="string">"MISS: Reached framework class. Abandoning search."</span>);</span><br><span class="line">        <span class="keyword">return</span> NOP_VIEW_BINDER;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class&lt;?&gt; viewBindingClass = Class.forName(clsName + <span class="string">"$$ViewBinder"</span>);</span><br><span class="line">        <span class="comment">//noinspection unchecked</span></span><br><span class="line">        viewBinder = (ViewBinder&lt;Object&gt;) viewBindingClass.newInstance();</span><br><span class="line">        <span class="keyword">if</span> (debug) Log.d(TAG, <span class="string">"HIT: Loaded view binder class."</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug) Log.d(TAG, <span class="string">"Not found. Trying superclass "</span> + cls.getSuperclass().getName());</span><br><span class="line">        viewBinder = findViewBinderForClass(cls.getSuperclass());</span><br><span class="line">    &#125;</span><br><span class="line">    BINDERS.put(cls, viewBinder);</span><br><span class="line">    <span class="keyword">return</span> viewBinder;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå…¶å®æ˜¯ä¸ºä¸€ä¸ªç±»åˆ›å»ºä¸€ä¸ªViewBinder<object>å¯¹è±¡ï¼Œå¹¶é€šè¿‡BINDERSåšå‡ºç¼“å­˜ã€‚è¿™é‡Œæ³¨æ„ä¸€ç‚¹: å½“æ£€æµ‹åˆ°æ—¶androidæˆ–è€…javaæ¡†æ¶åº“ä¸­çš„ç±»ï¼Œåˆ™ç«‹å³è¿”å›ï¼Œå¦åˆ™å°±ä¼šé»˜è®¤å»è¯»å–ç±»ä¸­çš„<code>clsName + &quot;$$ViewBinder&quot;</code>ç±»ï¼Œå¹¶ç”±è¿™ä¸ªç±»åˆ›å»ºå‡ºViewBinder<object>å¯¹è±¡ï¼ˆå¯ä»¥çŒœæµ‹å‡ºè¿™ä¸ªç±»å°±æ˜¯ViewBinder<object>ç±»å‹çš„ï¼‰ã€‚</object></object></object></p>
<p>å¯æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨ButterKnifeç±»çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰åˆ›å»ºè¿™ä¸ªå¥‡æ€ªçš„ç±»ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»æ¥è‡ªå“ªé‡Œå‘¢ï¼Ÿè¿™ä¸ªä¸‹ä¸€èŠ‚å†è§£é‡Šï¼Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹åˆ†æï¼Œåœ¨<code>findViewBinderForClass</code>ä¹‹åï¼Œè°ƒç”¨çš„å°±æ˜¯ä¸‹é¢çš„æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewBinder.bind(finder, target, source);</span><br></pre></td></tr></table></figure>
<p>ViewBinderåªæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ¡†æ¶é‡Œé¢æ²¡æœ‰ç›¸å…³å®ç°ï¼Œæ ¹æ®å‰é¢çš„åˆ†æï¼Œå…·ä½“çš„å®ç°åº”è¯¥åœ¨<code>clsName + &quot;$$ViewBinder&quot;</code>ç±»ä¸­ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å»æ‰¾<code>clsName + &quot;$$ViewBinder&quot;</code>ç±»å§ã€‚</p>
<h2 id="ç¼–è¯‘æ—¶æ³¨è§£â€”â€”ä»£ç ç”Ÿæˆ"><a href="#ç¼–è¯‘æ—¶æ³¨è§£â€”â€”ä»£ç ç”Ÿæˆ" class="headerlink" title="ç¼–è¯‘æ—¶æ³¨è§£â€”â€”ä»£ç ç”Ÿæˆ"></a>ç¼–è¯‘æ—¶æ³¨è§£â€”â€”ä»£ç ç”Ÿæˆ</h2><p>ç ”ç©¶ç¼–è¯‘æ—¶æ³¨è§£ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°Processorç±»ï¼ŒButterKnifeç±»çš„Processorç±»å«åš<code>ButterKnifeProcessor</code>ï¼Œå®ƒçš„<code>process</code>æ–¹æ³•å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span> <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">process</span><span class="params">(Set&lt;? extends TypeElement&gt; elements, RoundEnvironment env)</span> </span>&#123;</span><br><span class="line">    Map&lt;TypeElement, BindingClass&gt; targetClassMap = findAndParseTargets(env);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;TypeElement, BindingClass&gt; entry : targetClassMap.entrySet()) &#123;</span><br><span class="line">        TypeElement typeElement = entry.getKey();</span><br><span class="line">        BindingClass bindingClass = entry.getValue();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            bindingClass.brewJava().writeTo(filer);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            error(typeElement, <span class="string">"Unable to write view binder for type %s: %s"</span>, typeElement,</span><br><span class="line">            e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€ä¸ªå…³é”®ç‚¹æ˜¯è°ƒç”¨<code>findAndParseTargets</code>æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Map&lt;TypeElement, BindingClass&gt; <span class="title">findAndParseTargets</span><span class="params">(RoundEnvironment env)</span> </span>&#123;</span><br><span class="line">    Map&lt;TypeElement, BindingClass&gt; targetClassMap = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">    Set&lt;String&gt; erasedTargetNames = <span class="keyword">new</span> LinkedHashSet&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process each @Bind element.</span></span><br><span class="line">    <span class="keyword">for</span> (Element element : env.getElementsAnnotatedWith(Bind.class)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!SuperficialValidation.validateElement(element)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            parseBind(element, targetClassMap, erasedTargetNames);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logParsingError(element, Bind.class, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process each annotation that corresponds to a listener.</span></span><br><span class="line">    <span class="keyword">for</span> (Class&lt;? extends Annotation&gt; listener : LISTENERS) &#123;</span><br><span class="line">        findAndParseListener(env, listener, targetClassMap, erasedTargetNames);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process each @BindArray element.</span></span><br><span class="line">    <span class="keyword">for</span> (Element element : env.getElementsAnnotatedWith(BindArray.class)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!SuperficialValidation.validateElement(element)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">             parseResourceArray(element, targetClassMap, erasedTargetNames);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            logParsingError(element, BindArray.class, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Process each @BindBitmap element.</span></span><br><span class="line">    <span class="comment">// Process each @BindBool element.</span></span><br><span class="line">    <span class="comment">// Process each @BindColor element.</span></span><br><span class="line">    <span class="comment">// Process each @BindDimen element.</span></span><br><span class="line">    <span class="comment">// Process each @BindDrawable element.</span></span><br><span class="line">    <span class="comment">// Process each @BindInt element.</span></span><br><span class="line">    <span class="comment">// Process each @BindString element.    </span></span><br><span class="line">    <span class="comment">// Process each @Unbinder element.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Try to find a parent binder for each.</span></span><br><span class="line">    <span class="keyword">for</span> (Map.Entry&lt;TypeElement, BindingClass&gt; entry : targetClassMap.entrySet()) &#123;</span><br><span class="line">        String parentClassFqcn = findParentFqcn(entry.getKey(), erasedTargetNames);</span><br><span class="line">        <span class="keyword">if</span> (parentClassFqcn != <span class="keyword">null</span>) &#123;</span><br><span class="line">            entry.getValue().setParentViewBinder(parentClassFqcn + BINDING_CLASS_SUFFIX);</span><br><span class="line">        &#125;</span><br><span class="line">     &#125;</span><br><span class="line">      </span><br><span class="line">     <span class="keyword">return</span> targetClassMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç²—ç•¥ä¸€çœ‹ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯éå†å¹¶ä¸”æ•´ç†æ‰€æœ‰ä½¿ç”¨ButterKnifeæ³¨è§£çš„å…ƒç´ ï¼Œè¯¦ç»†æš‚æ—¶ç•¥å»ä¸è¡¨ã€‚</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼šåœ¨éå†è¿™äº›å…ƒç´ ä¹‹åå†éå†<code>targetClassMap</code>ï¼Œç„¶åè°ƒç”¨<code>bindingClass.brewJava().writeTo(filer);</code>æ–¹æ³•åˆ›å»ºæ–‡ä»¶ï¼Œè¿™å°±ç®—ç”Ÿæˆå¤„ç†å®Œäº†ï¼Œé‚£ä¹ˆåˆ°åº•ç”Ÿæˆäº†ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Ÿ</p>
<h3 id="ç¼–è¯‘æ—¶æ³¨è§£è¿è¡Œç»“æœ"><a href="#ç¼–è¯‘æ—¶æ³¨è§£è¿è¡Œç»“æœ" class="headerlink" title="ç¼–è¯‘æ—¶æ³¨è§£è¿è¡Œç»“æœ"></a>ç¼–è¯‘æ—¶æ³¨è§£è¿è¡Œç»“æœ</h3><p>è¿™é‡Œå·ä¸ªæ‡’ï¼Œä¹Ÿæ˜¯ä¸ºäº†æ›´å¿«æ·çš„è¾¾åˆ°ç›®æ ‡ï¼šå› ä¸ºæœ‰module butterknife-sampleï¼Œæ‰€ä»¥ButterKnifeå¯ä»¥ç›´æ¥å½“åšåº”ç”¨è¿è¡Œã€‚æˆ‘ä»¬runä¸€ä¸‹ï¼Œç„¶ååœ¨è¯¥ä¸‹é¢ç›®å½•ç»“æ„ä¸‹å°±å¯ä»¥çœ‹åˆ°ä¸€äº›æ–‡ä»¶:</p>
<div align="center"><img src="http://7xktd8.com1.z0.glb.clouddn.com/Butter-Knifeç”Ÿæˆç±».png" height="250" alt="Butter-Knifeç”Ÿæˆç±»"></div>

<p>å¦‚å›¾ï¼Œåœ¨è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°è¿è¡Œæ—¶æ³¨è§£è‡ªåŠ¨ç”Ÿæˆçš„ç±»â€”â€”ç±»åæ˜¯ä»¥<code>$$ViewBinder</code>ç»“å°¾çš„ï¼Œä»¥<code>SimpleActivity$$ViewBinder</code>ä¸ºä¾‹ï¼Œå®ƒçš„å†…å®¹å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleActivity</span>$$<span class="title">ViewBinder</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">SimpleActivity</span>&gt; <span class="keyword">implements</span> <span class="title">ViewBinder</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> SimpleActivity$$ViewBinder() &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(Finder finder, <span class="keyword">final</span> T target, Object source)</span> </span>&#123;</span><br><span class="line">        SimpleActivity$$ViewBinder.Unbinder unbinder = <span class="keyword">new</span> SimpleActivity$$ViewBinder.Unbinder(target);</span><br><span class="line">        View view = (View)finder.findRequiredView(source, <span class="number">2130968576</span>, <span class="string">"field \'title\'"</span>);</span><br><span class="line">        target.title = (TextView)finder.castView(view, <span class="number">2130968576</span>, <span class="string">"field \'title\'"</span>);</span><br><span class="line">        view = (View)finder.findRequiredView(source, <span class="number">2130968577</span>, <span class="string">"field \'subtitle\'"</span>);</span><br><span class="line">        target.subtitle = (TextView)finder.castView(view, <span class="number">2130968577</span>, <span class="string">"field \'subtitle\'"</span>);</span><br><span class="line">        view = (View)finder.findRequiredView(source, <span class="number">2130968578</span>, <span class="string">"field \'hello\', method \'sayHello\', and method \'sayGetOffMe\'"</span>);</span><br><span class="line">        target.hello = (Button)finder.castView(view, <span class="number">2130968578</span>, <span class="string">"field \'hello\'"</span>);</span><br><span class="line">        unbinder.view2130968578 = view;</span><br><span class="line">        view.setOnClickListener(<span class="keyword">new</span> DebouncingOnClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doClick</span><span class="params">(View p0)</span> </span>&#123;</span><br><span class="line">                target.sayHello();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        view.setOnLongClickListener(<span class="keyword">new</span> OnLongClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onLongClick</span><span class="params">(View p0)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> target.sayGetOffMe();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        view = (View)finder.findRequiredView(source, <span class="number">2130968579</span>, <span class="string">"field \'listOfThings\' and method \'onItemClick\'"</span>);</span><br><span class="line">        target.listOfThings = (ListView)finder.castView(view, <span class="number">2130968579</span>, <span class="string">"field \'listOfThings\'"</span>);</span><br><span class="line">        unbinder.view2130968579 = view;</span><br><span class="line">        ((AdapterView)view).setOnItemClickListener(<span class="keyword">new</span> OnItemClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onItemClick</span><span class="params">(AdapterView&lt;?&gt; p0, View p1, <span class="keyword">int</span> p2, <span class="keyword">long</span> p3)</span> </span>&#123;</span><br><span class="line">                target.onItemClick(p2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        view = (View)finder.findRequiredView(source, <span class="number">2130968580</span>, <span class="string">"field \'footer\'"</span>);</span><br><span class="line">        target.footer = (TextView)finder.castView(view, <span class="number">2130968580</span>, <span class="string">"field \'footer\'"</span>);</span><br><span class="line">        target.headerViews = Utils.listOf(<span class="keyword">new</span> View[]&#123;(View)finder.findRequiredView(source, <span class="number">2130968576</span>, <span class="string">"field \'headerViews\'"</span>), (View)finder.findRequiredView(source, <span class="number">2130968577</span>, <span class="string">"field \'headerViews\'"</span>), (View)finder.findRequiredView(source, <span class="number">2130968578</span>, <span class="string">"field \'headerViews\'"</span>)&#125;);</span><br><span class="line">        target.unbinder = unbinder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Unbinder</span> <span class="keyword">implements</span> <span class="title">butterknife</span>.<span class="title">ButterKnife</span>.<span class="title">Unbinder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> SimpleActivity target;</span><br><span class="line">        View view2130968578;</span><br><span class="line">        View view2130968579;</span><br><span class="line"></span><br><span class="line">        Unbinder(SimpleActivity target) &#123;</span><br><span class="line">            <span class="keyword">this</span>.target = target;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">unbind</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">this</span>.target == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"Bindings already cleared."</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.target.title = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.target.subtitle = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.view2130968578.setOnClickListener((OnClickListener)<span class="keyword">null</span>);</span><br><span class="line">                <span class="keyword">this</span>.view2130968578.setOnLongClickListener((OnLongClickListener)<span class="keyword">null</span>);</span><br><span class="line">                <span class="keyword">this</span>.target.hello = <span class="keyword">null</span>;</span><br><span class="line">                ((AdapterView)<span class="keyword">this</span>.view2130968579).setOnItemClickListener((OnItemClickListener)<span class="keyword">null</span>);</span><br><span class="line">                <span class="keyword">this</span>.target.listOfThings = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.target.footer = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.target.headerViews = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.target.unbinder = <span class="keyword">null</span>;</span><br><span class="line">                <span class="keyword">this</span>.target = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªç±»å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ç±»ï¼Œä¹Ÿæ˜¯ <strong>æ³¨è§£è§£æ</strong> ä¸€èŠ‚ä¸­è°ƒç”¨<code>Binder.bind()</code>æ–¹æ³•æ—¶ç”¨äºç»‘å®šçš„ç±»ï¼Œæ³¨æ„è¿™ä¸ªç±»ï¼šå®ƒå®ç°äº†ViewBinderæ¥å£ã€‚å†çœ‹ä¸€ä¸‹<code>bind</code>æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bind</span><span class="params">(@NonNull Object target, @NonNull Object source, @NonNull Finder finder)</span> </span>&#123;</span><br><span class="line">    Class&lt;?&gt; targetClass = target.getClass();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (debug) Log.d(TAG, <span class="string">"Looking up view binder for "</span> + targetClass.getName());</span><br><span class="line">        ViewBinder&lt;Object&gt; viewBinder = findViewBinderForClass(targetClass);</span><br><span class="line">        viewBinder.bind(finder, target, source);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Unable to bind views for "</span> + targetClass.getName(), e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>viewBinder.bind(finder, target, source);</code>è°ƒç”¨çš„å°±æ˜¯ç”Ÿæˆç±»ä¸­çš„<code>bind</code>æ–¹æ³•ã€‚æˆ‘ä»¬å–æ–¹æ³•ä¸­çš„ä¸€å°æ®µæ¥çœ‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">View view = (View)finder.findRequiredView(source, <span class="number">2130968576</span>, <span class="string">"field \'title\'"</span>);</span><br><span class="line">target.title = (TextView)finder.castView(view, <span class="number">2130968576</span>, <span class="string">"field \'title\'"</span>);</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå°±é€šè¿‡finderçš„<code>findRequiredView</code>å’Œ<code>castView</code>ä¸¤ä¸ªæ–¹æ³•æ¥ä¸ºtargetçš„titleå±æ€§æ¥èµ‹å€¼äº†ã€‚è¿™é‡Œå…¶å®ç•¥æœ‰å¤šä½™ï¼Œä¸éœ€è¦å†æ·»åŠ <code>(TextView)</code>å¼ºè½¬ï¼Œçœ‹ä¸€ä¸‹<code>castView</code>æ–¹æ³•çš„å®ç°å°±å¥½äº†:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">castView</span><span class="params">(View view, <span class="keyword">int</span> id, String who)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> (T) view;</span><br><span class="line">   &#125; <span class="keyword">catch</span> (ClassCastException e) &#123;</span><br><span class="line">   		<span class="keyword">if</span> (who == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError();</span><br><span class="line">		&#125;</span><br><span class="line">      	String name = getResourceEntryName(view, id);</span><br><span class="line">      	<span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">"View '"</span></span><br><span class="line">          + name</span><br><span class="line">          + <span class="string">"' with ID "</span></span><br><span class="line">          + id</span><br><span class="line">          + <span class="string">" for "</span></span><br><span class="line">          + who</span><br><span class="line">          + <span class="string">" was of the wrong type. See cause for more info."</span>, e);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå·²ç»ä½¿ç”¨æ³›å‹è¿›è¡Œå¼ºè½¬äº†ã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥æ˜ç™½ButterKnifeçš„å®ç°åŸç†äº†:<br><strong>ä¸ºæ³¨è§£ç±»ç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„ViewBinderç±»ï¼Œè‡ªåŠ¨ç”Ÿæˆ<code>findViewById</code>ç­‰æ¨¡æ¿ä»£ç ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œåå°„å®ä¾‹åŒ–ViewBinderç±»ï¼Œè°ƒç”¨å®ƒçš„<code>bind()</code>æ–¹æ³•å®Œæˆæ³¨è§£â€”â€”è¿™é‡Œåªæœ‰åœ¨ç”ŸæˆViewBinderå¯¹è±¡çš„æ—¶å€™ä½¿ç”¨äº†åå°„ï¼Œå…¶ä½™ä»£ç å‡æ˜¯æ­£å¸¸çš„è°ƒç”¨ã€‚</strong></p>
<p>ä»ç”Ÿæˆçš„ä»£ç é‡Œé¢è¿˜å¯ä»¥çœ‹åˆ°Unbinderè¿™ä¸ªå†…éƒ¨ç±»ï¼šç”Ÿæˆå®ƒæ˜¯å› ä¸ºSimpleActivityé‡Œé¢æœ‰è¿™æ ·çš„ç”¨æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Unbinder</span> ButterKnife.Unbinder unbinder;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>unbinder()</code>æ–¹æ³•é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æŠŠæ³¨å…¥çš„å†…å®¹å…¨éƒ¨åˆ é™¤äº†ï¼Œè¿™ä¹Ÿå°±æ˜¯<code>@Unbinder</code>æ³¨è§£çš„ä½¿ç”¨æ–¹æ³•ã€‚</p>
<p>å¥½äº†ï¼Œåˆ°äº†è¿™é‡Œï¼Œæˆ‘ä»¬å¤§è‡´èƒ½çŸ¥é“ButterKnifeæ˜¯æ€ä¹ˆç©çš„äº†ï¼Œä½†æ˜¯å…·ä½“å¦‚ä½•ç”Ÿæˆç±»è¿™ä¸€å—è¿˜ä¸æ˜¯å¾ˆæ¸…æ¥šã€‚<strong>ä¸‹ä¸€èŠ‚æˆ‘ä»¬æ¥é‡ç‚¹åˆ†æï¼šButterKnifeæ˜¯å¦‚ä½•ç”Ÿæˆä¸€ä¸ªç±»çš„ã€‚</strong></p>
<h1 id="ç”Ÿæˆç±»"><a href="#ç”Ÿæˆç±»" class="headerlink" title="ç”Ÿæˆç±»"></a>ç”Ÿæˆç±»</h1><p>è®²è§£è¿™ä¸ªéœ€è¦æˆ‘ä»¬åŸºäºå‰é¢çš„åˆ†æï¼Œåœ¨<code>findAndParseTargets</code>æ–¹æ³•ä¸­ï¼Œæœ‰å¾ˆå¤šçš„<code>parseXXX</code>æ–¹æ³•è°ƒç”¨ã€‚æ ¹æ®å‰é¢çš„åˆ†æï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šä¸€ä¸ªæ³¨è§£ç±»XXXä¼šå¯¹åº”ç”Ÿæˆ<code>XXX$$ViewBinder</code>ç±»ï¼Œé‚£ä¹ˆæˆ‘ä»¬å…ˆç¡®å®šï¼šButterKnifeå¦‚ä½•ç¡®å®šéœ€è¦ç”Ÿæˆå“ªäº›ç±»ï¼Œå±æ€§åˆæ˜¯å¦‚ä½•è§„æ•´åˆ°è¿™äº›ç±»é‡Œé¢å»çš„ï¼Ÿå³ï¼šæ€ä¹ˆçŸ¥é“ç”Ÿæˆä¸€ä¸ªç±»çš„æ‰€æœ‰ä¿¡æ¯ã€‚</p>
<h2 id="è§£æè¿‡ç¨‹"><a href="#è§£æè¿‡ç¨‹" class="headerlink" title="è§£æè¿‡ç¨‹"></a>è§£æè¿‡ç¨‹</h2><p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª<code>parseResourceInt</code>æ–¹æ³•ï¼Œè¿™æ˜¯å¤„ç†æ‰€æœ‰çš„Intèµ„æºçš„ç±»:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">parseResourceInt</span><span class="params">(Element element, Map&lt;TypeElement, BindingClass&gt; targetClassMap,</span></span></span><br><span class="line"><span class="function"><span class="params">                                  Set&lt;String&gt; erasedTargetNames)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">boolean</span> hasError = <span class="keyword">false</span>;</span><br><span class="line">	<span class="comment">// A</span></span><br><span class="line">	TypeElement enclosingElement = (TypeElement) element.getEnclosingElement();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Verify that the target type is int.</span></span><br><span class="line">	<span class="keyword">if</span> (element.asType().getKind() != TypeKind.INT) &#123;</span><br><span class="line">		error(element, <span class="string">"@%s field type must be 'int'. (%s.%s)"</span>, BindInt.class.getSimpleName(),</span><br><span class="line">		enclosingElement.getQualifiedName(), element.getSimpleName());</span><br><span class="line">		hasError = <span class="keyword">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Verify common generated code restrictions.</span></span><br><span class="line">	hasError |= isInaccessibleViaGeneratedCode(BindInt.class, <span class="string">"fields"</span>, element);</span><br><span class="line">	hasError |= isBindingInWrongPackage(BindInt.class, element);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (hasError) &#123;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Assemble information on the field.</span></span><br><span class="line">	String name = element.getSimpleName().toString();</span><br><span class="line">	<span class="keyword">int</span> id = element.getAnnotation(BindInt.class).value();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// B</span></span><br><span class="line">	BindingClass bindingClass = getOrCreateTargetClass(targetClassMap, enclosingElement);</span><br><span class="line">	FieldResourceBinding binding = <span class="keyword">new</span> FieldResourceBinding(id, name, <span class="string">"getInteger"</span>, <span class="keyword">false</span>);</span><br><span class="line">	bindingClass.addResource(binding);</span><br><span class="line"></span><br><span class="line">	erasedTargetNames.add(enclosingElement.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çœ‹Aå¤„ï¼Œè¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ª<code>getEnclosingElement()</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¹²å•¥çš„å‘¢ï¼Ÿå®˜ç½‘æ–‡æ¡£è§£é‡Šå¦‚ä¸‹:</p>
<blockquote>
<p>è¿”å›æ­¤å…ƒç´ ç›´æ¥å°è£…ï¼ˆéä¸¥æ ¼æ„ä¹‰ä¸Šï¼‰çš„å…ƒç´ ã€‚ ç±»æˆ–æ¥å£è¢«è®¤ä¸ºç”¨äºå°è£…å®ƒç›´æ¥å£°æ˜çš„å­—æ®µã€æ–¹æ³•ã€æ„é€ æ–¹æ³•å’Œæˆå‘˜ç±»å‹ã€‚è¿™åŒ…æ‹¬æ‰€æœ‰ï¼ˆéšå¼ï¼‰é»˜è®¤æ„é€ æ–¹æ³•å’Œæšä¸¾ç±»å‹çš„éšå¼ values å’Œ valueOf æ–¹æ³•ã€‚ åŒ…å°è£…ä½äºå…¶ä¸­çš„é¡¶å±‚ç±»å’Œæ¥å£ï¼Œä½†ä¸è®¤ä¸ºå®ƒå°è£…äº†å­åŒ…ã€‚ å½“å‰ä¸è®¤ä¸ºå…¶ä»–ç§ç±»çš„å…ƒç´ å°è£…äº†ä»»ä½•å…ƒç´ ï¼›ä½†æ˜¯ï¼Œéšç€æ­¤ API æˆ–ç¼–ç¨‹è¯­è¨€çš„å‘å±•ï¼Œè¿™ç§æƒ…å†µå¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚</p>
</blockquote>
<p>ä»ButterKnifeçš„æ³¨è§£å®šä¹‰æ¥çœ‹ï¼Œæ³¨è§£ä½¿ç”¨åœ¨æ–¹æ³•æˆ–è€…å±æ€§ä¸Šé¢ï¼Œé‚£ä¹ˆé€šè¿‡è¿™ä¸ªæ–¹æ³•å°±å¯ä»¥è·å–åˆ°å°è£…è¿™äº›å…ƒç´ çš„ç±»ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹Bå¤„ï¼Œå…ˆçœ‹ä¸€ä¸‹<code>getOrCreateTargetClass</code>æ–¹æ³•:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BINDING_CLASS_SUFFIX = <span class="string">"$$ViewBinder"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> BindingClass <span class="title">getOrCreateTargetClass</span><span class="params">(Map&lt;TypeElement, BindingClass&gt; targetClassMap, TypeElement enclosingElement)</span> </span>&#123;</span><br><span class="line">	BindingClass bindingClass = targetClassMap.get(enclosingElement);</span><br><span class="line">	<span class="keyword">if</span> (bindingClass == <span class="keyword">null</span>) &#123;</span><br><span class="line">		String targetType = enclosingElement.getQualifiedName().toString();</span><br><span class="line">		String classPackage = getPackageName(enclosingElement);</span><br><span class="line">		String className = getClassName(enclosingElement, classPackage) + BINDING_CLASS_SUFFIX;</span><br><span class="line"></span><br><span class="line">		bindingClass = <span class="keyword">new</span> BindingClass(classPackage, className, targetType);</span><br><span class="line">		targetClassMap.put(enclosingElement, bindingClass);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> bindingClass;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»£ç å¾ˆæ¸…æ¥šï¼šè¿™é‡Œä¼šå¾€targetClassMapé‡Œé¢å­˜å‚¨ä¸€ä¸ªEntryï¼ŒKeyä¸ºenclosingElementï¼ˆå³å¤–éƒ¨ç±»ï¼‰ï¼ŒValueä¸ºBindingClassã€‚BindingClassåˆå§‹åŒ–è®°å½•äº†ä¸‰æ ·ä¸œè¥¿: åŸå…ˆçš„æ³¨è§£ç±»ç±»åã€åŸå…ˆçš„æ³¨è§£ç±»æ‰€åœ¨åŒ…åå’Œè¦ç”Ÿæˆçš„æ³¨è§£ç±»ç±»åï¼ˆ<code>XXX$$ViewBinder</code>ï¼‰ã€‚</p>
<p>æˆ‘ä»¬ç»§ç»­çœ‹Bå¤„ï¼Œåœ¨è·å–åˆ°è¿™ä¸ªBindingClassä¹‹åï¼Œå°±æ‰§è¡Œå¦‚ä¸‹ä»£ç :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FieldResourceBinding binding = <span class="keyword">new</span> FieldResourceBinding(id, name, <span class="string">"getInteger"</span>, <span class="keyword">false</span>);</span><br><span class="line">bindingClass.addResource(binding);</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªä»£ç ç”Ÿæˆä¸€ä¸ªFieldResourceBindingå¯¹è±¡ç„¶åæ·»åŠ åˆ°BindingClassä¸­ã€‚</p>
<p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•´ä¸ªè§£æè¿‡ç¨‹: <strong>éå†æ‰€æœ‰çš„æ³¨è§£å…ƒç´ ï¼Œå¹¶é€šè¿‡<code>getEnclosingElement()</code>è·å–å£°æ˜è¿™äº›å…ƒç´ çš„ç±»ï¼Œæ‰€æœ‰éœ€è¦åˆ›å»ºçš„ç±»ä¿¡æ¯éƒ½ç»´æŠ¤åœ¨<code>targetClassMap</code>Mapæ•°æ®ç»“æ„ä¸­ï¼ŒKeyä¸ºæ³¨è§£ä½¿ç”¨ç±»ï¼ŒValueä¸ºBindingClassâ€”â€”åç»­å°†æ ¹æ®è¿™ä¸ªBindingClassç”Ÿæˆä»£ç ã€‚æ‰€æœ‰çš„æ³¨è§£å…ƒç´ éƒ½å°†ç»è¿‡è§£æå­˜å‚¨åˆ°BindingClassä¸­ï¼ˆç±»ä¼¼FieldResourceBindingè¿™æ ·çš„å±æ€§ï¼‰ï¼Œæœ€ç»ˆè§£æå®Œæˆï¼Œæ‰€æœ‰éœ€è¦ç”Ÿæˆçš„ç±»éƒ½å¯ä»¥é€šè¿‡<code>targetClassMap</code>ç´¢å¼•åˆ°</strong>ã€‚</p>
<h2 id="å†™å…¥è¿‡ç¨‹"><a href="#å†™å…¥è¿‡ç¨‹" class="headerlink" title="å†™å…¥è¿‡ç¨‹"></a>å†™å…¥è¿‡ç¨‹</h2><p>å†™å…¥è¿‡ç¨‹æ˜¯è¿™æ ·çš„:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (Map.Entry&lt;TypeElement, BindingClass&gt; entry : targetClassMap.entrySet()) &#123;</span><br><span class="line">	TypeElement typeElement = entry.getKey();</span><br><span class="line">	BindingClass bindingClass = entry.getValue();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		bindingClass.brewJava().writeTo(filer);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">		error(typeElement, <span class="string">"Unable to write view binder for type %s: %s"</span>, typeElement, e.getMessage());</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œå°±æ˜¯éå†æ‰€æœ‰çš„BindingClassï¼Œè°ƒç”¨<code>brewJava()</code>ï¼Œè¿™ä¸ªæ–¹æ³•æ¶‰åŠåˆ°çš„çŸ¥è¯†ä»¥åŠåé¢<code>writeTo()</code>æ–¹æ³•å‡æ¥è‡ªäº<a href="https://github.com/square/javapoet" target="_blank" rel="noopener">javapoeté¡¹ç›®</a>ï¼Œè¿™ä¸ªé¡¹ç›®å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ ¹æ®ä¸€äº›ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªJavaç±»ï¼Œæ­¤å¤„ä¸èµ˜è¿°ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>ButterKnifeä¸ä½†ä½¿ç”¨æ–¹ä¾¿ï¼Œè€Œä¸”é€šè¿‡ç¼–è¯‘æ—¶æ³¨è§£ï¼Œå‡å°‘äº†åå°„çš„ä½¿ç”¨ï¼Œæé«˜äº†æ³¨è§£è§£æçš„æ•ˆç‡ï¼Œç¡®å®éå¸¸èµã€‚</p>
<p>æœ€åæ¨èä¸€ä¸ªAndroid Studioæ’ä»¶ç”¨äºç”ŸæˆButterKnifeä»£ç ï¼Œåœ°å€å¦‚ä¸‹: <a href="https://github.com/avast/android-butterknife-zelezny" target="_blank" rel="noopener">android-butterknife-zelezny</a>ï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿç”ŸæˆButterKnifeæ³¨è§£ä»£ç ã€‚</p>
<p>é‰´äºæŸäº›é¡¹ç›®ç”±äºæ–¹æ³•æ•°é—®é¢˜æˆ–è€…å…¶ä½™åŸå› æ²¡æœ‰ä½¿ç”¨ButterKnifeï¼Œç¨‹åºå‘˜ä»¬è¢«é€¼è¦å†™<code>findViewById</code>è¿™æ ·çš„ä»£ç ï¼Œè¿˜å¾—å»XMLé‡Œé¢ç¿»æ‰¾idï¼Œæˆ‘åŸºäºä»¥ä¸Šæ’ä»¶ï¼Œæ”¹å†™äº†å¦å¤–ä¸€ä¸ªæ’ä»¶ï¼Œåœ°å€å¦‚ä¸‹ï¼š<a href="https://github.com/BigFootprint/AndroidViewGenerator" target="_blank" rel="noopener">AndroidViewGenerator</a>ï¼Œæ¬¢è¿ä½¿ç”¨ã€‚</p>
</div><div class="tags"><a href="/tags/æºç /">æºç </a></div><div class="post-nav"><a href="/2016/04/21/Apk-reverse-engineering/" class="pre">åç¼–è¯‘APK</a><a href="/2016/03/24/mvc-mvp-mvvm/" class="next">MVCï¼ŒMVPï¼ŒMVVM</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">59</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ReactiveX/">ReactiveX</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/åç«¯/">åç«¯</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å·¥å…·/">å·¥å…·</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å½±è§†/">å½±è§†</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç”µå½±/">ç”µå½±</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/Gitbook/" style="font-size: 15px;">Gitbook</a> <a href="/tags/Runtime/" style="font-size: 15px;">Runtime</a> <a href="/tags/è§†å›¾/" style="font-size: 15px;">è§†å›¾</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/æƒé™/" style="font-size: 15px;">æƒé™</a> <a href="/tags/ä»£ç ä¼˜åŒ–/" style="font-size: 15px;">ä»£ç ä¼˜åŒ–</a> <a href="/tags/Framework/" style="font-size: 15px;">Framework</a> <a href="/tags/æ€§èƒ½ä¼˜åŒ–/" style="font-size: 15px;">æ€§èƒ½ä¼˜åŒ–</a> <a href="/tags/å·¥å…·/" style="font-size: 15px;">å·¥å…·</a> <a href="/tags/åˆé›†/" style="font-size: 15px;">åˆé›†</a> <a href="/tags/ADB/" style="font-size: 15px;">ADB</a> <a href="/tags/æºç /" style="font-size: 15px;">æºç </a> <a href="/tags/åç¼–è¯‘/" style="font-size: 15px;">åç¼–è¯‘</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/åŸºç¡€/" style="font-size: 15px;">åŸºç¡€</a> <a href="/tags/æ•ˆç‡/" style="font-size: 15px;">æ•ˆç‡</a> <a href="/tags/MarkDown/" style="font-size: 15px;">MarkDown</a> <a href="/tags/ç”µå½±/" style="font-size: 15px;">ç”µå½±</a> <a href="/tags/Reactive/" style="font-size: 15px;">Reactive</a> <a href="/tags/AIDL/" style="font-size: 15px;">AIDL</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/é©±åŠ¨/" style="font-size: 15px;">é©±åŠ¨</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/æ—¥å¿—/" style="font-size: 15px;">æ—¥å¿—</a> <a href="/tags/äº‹ä»¶/" style="font-size: 15px;">äº‹ä»¶</a> <a href="/tags/ä»£ç è®¾è®¡/" style="font-size: 15px;">ä»£ç è®¾è®¡</a> <a href="/tags/ç½‘ç»œ/" style="font-size: 15px;">ç½‘ç»œ</a> <a href="/tags/æµ‹è¯•/" style="font-size: 15px;">æµ‹è¯•</a> <a href="/tags/Binder/" style="font-size: 15px;">Binder</a> <a href="/tags/Groovy/" style="font-size: 15px;">Groovy</a> <a href="/tags/Loader/" style="font-size: 15px;">Loader</a> <a href="/tags/RAC/" style="font-size: 15px;">RAC</a> <a href="/tags/äº‹ä»¶å¤„ç†/" style="font-size: 15px;">äº‹ä»¶å¤„ç†</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/AIDL-åŸç†åˆ†æ/">AIDL åŸç†åˆ†æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/App-å¯åŠ¨è¿‡ç¨‹/">App å¯åŠ¨è¿‡ç¨‹</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/PMS-è§£æ/">PMS è§£æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/WMS-è§£æ/">WindowManagerService è§£æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/AMS-è§£æ/">AMS è§£æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/The-Good-Wife/">The-Good-Wife</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/Black-Sails/">é»‘å¸†</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/29/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/XCode-8-2-1-ClangFormat-æ’ä»¶å®‰è£…/">XCode 8.2.1 ClangFormat æ’ä»¶å®‰è£…</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/SourceTree-åˆ†æ”¯å›¾è°±/">SourceTree åˆ†æ”¯å›¾è°±</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2018 <a href="/." rel="nofollow">èœ—ç‰›å£³.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>