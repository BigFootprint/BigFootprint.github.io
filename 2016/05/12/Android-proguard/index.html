<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="æå…¨æ°‘çš„ä¸ªäººåšå®¢"><title>Proguard | èœ—ç‰›å£³</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-65882749-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Proguard</h1><a id="logo" href="/.">èœ—ç‰›å£³</a><p class="description">è®¡ç®—æœºåªæœ‰ 0 å’Œ 1 ï¼Œä½†ä¸–ç•Œæ˜¯è¿ç»­çš„</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> é¦–é¡µ</i></a><a href="/archives/"><i class="fa fa-archive"> å½’æ¡£</i></a><a href="/about/"><i class="fa fa-user"> å…³äº</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Proguard</h1><div class="post-meta">May 12, 2016<span> | </span><span class="category"><a href="/categories/Android/">Android</a></span></div><div class="post-content"><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><strong>Proguard</strong> ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol>
<li>åˆ›å»ºæ›´åŠ ç´§å‡‘çš„ä»£ç ï¼Œè®©æœ€ç»ˆçš„ä»£ç æ›´åŠ å°å·§ï¼Œå¯ä»¥æ›´å¿«çš„åœ¨ç½‘ç»œä¸Šä¼ è¾“ã€åŠ è½½ï¼Œè¿è¡Œæ—¶å¯ä»¥æ¶ˆè€—æ›´å°çš„å†…å­˜ï¼›</li>
<li>æ··æ·†ä»£ç ï¼Œä½¿å¾—ç¨‹åºé€†å‘å·¥ç¨‹èµ·æ¥æ›´åŠ å›°éš¾ï¼›</li>
<li>åˆ—å‡ºæ— ç”¨çš„ä»£ç ï¼Œä»¥ä¾¿äºå¯ä»¥ç§»é™¤å®ƒä»¬ï¼›</li>
<li>é‡æ–°å®šä½ä»¥åŠæ ¡éªŒ Java 6 ä»¥åŠä»¥ä¸Šç‰ˆæœ¬çš„ class æ–‡ä»¶ï¼šæ·»åŠ é¢„æ ¡éªŒä¿¡æ¯åˆ°classæ–‡ä»¶ä¸­å»ï¼Œå‡è½» ClassLoader çš„æ ¡éªŒè´Ÿæ‹…â€”â€”è¯¦ç»†è§£é‡Šå¯è§<a href="http://proguard.sourceforge.net/FAQ.html#preverification" target="_blank" rel="noopener">What is preverification?</a>ï¼›</li>
</ol>
<a id="more"></a><strong>Proguard</strong> æ‰§è¡Œèµ·æ¥çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ•ˆæœæ˜¾è‘—ï¼Œå¹¶ä¸”åœ¨ Antã€Gradle ç­‰å·¥å…·ä¸Šå·²æœ‰æ’ä»¶å®ç°ã€‚é€šè¿‡ç®€å•çš„æ¨¡æ¿åŒ–çš„é…ç½®åŠ ä¸Šç®€å•çš„å‘½ä»¤è¡Œé€‰é¡¹ï¼Œé€šå¸¸å°±è¶³å¤Ÿå¯¹æˆ‘ä»¬çš„ä»£ç åšå‡ºå‡ºè‰²çš„ä¼˜åŒ–ã€‚<br><br>&gt;1. å…·ä½“çš„ä¼˜åŒ–ç»“æœå¯ä»¥æŸ¥çœ‹<a href="http://proguard.sourceforge.net/results.html" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼›<br>&gt;2. é€šè¿‡åˆ é™¤æ— ç”¨çš„ä»£ç (åŒ…æ‹¬ä¼˜åŒ–åº“æ–‡ä»¶)ä»¥åŠå°†å˜é‡åç±»åç®€åŒ–ï¼Œå¯ä»¥å¤§å¹…åº¦å‡å°åŒ…çš„ä½“ç§¯ï¼›<br>&gt;3. Proguard ä¸“é—¨ä¸º Android å®šåˆ¶äº†ä¸€ä¸ªä¼˜åŒ–å’Œæ··æ·†ç‰ˆæœ¬: <strong>DexGuard</strong>ã€‚å®ƒä¸“æ³¨äº App çš„ä¿æŠ¤ï¼Œå¦å¤–æä¾›è¯¸å¦‚èµ„æºæ··æ·†ã€å­—ç¬¦ä¸²åŠ å¯†ã€ç±»åŠ å¯†ã€dexåˆ‡åˆ†ç­‰åŠŸèƒ½ã€‚å®ƒç›´æ¥åˆ›å»º Dalvik å­—èŠ‚ç ã€‚<br><br><strong>Proguard</strong>å¯¹ä»£ç çš„å¤„ç†è¿‡ç¨‹å¦‚ä¸‹:<br><br><img src="http://7xktd8.com1.z0.glb.clouddn.com/Proguardä¼˜åŒ–è¿‡ç¨‹.png" alt="Proguardä¼˜åŒ–è¿‡ç¨‹"><br>å¦‚å›¾æ‰€ç¤ºï¼Œ<strong>Proguard</strong> è¯»å– Input jarsï¼Œç»è¿‡ä¸€ç³»åˆ—å¤„ç†ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ª Output jarsã€‚ä¼˜åŒ–è¿‡ç¨‹æ˜¯å¯ä»¥å¤šæ¬¡è¿›è¡Œçš„ã€‚<br><br>Proguard è¦æ±‚æŒ‡æ˜ Input jars çš„ Library jars â€”â€” å®ƒä»¬æ˜¯ä½ ç”¨æ¥ç¼–è¯‘ä»£ç çš„åº“æ–‡ä»¶ã€‚åº“æ–‡ä»¶å§‹ç»ˆä¿æŒä¸å˜ã€‚<br><br>### Entry points<br>ä¸ºäº†ç¡®å®šå“ªäº›ä»£ç åº”è¯¥è¢«ä¿ç•™ï¼Œå“ªäº›åº”è¯¥è¢«ä¸¢å¼ƒæˆ–è€…æ··æ·†ï¼Œå¼€å‘è€…åº”è¯¥ä¸ºä»£ç æŒ‡å®šè‹¥å¹²<strong><code>entry points</code></strong>ã€‚è¿™äº› entry points é€šå¸¸æ˜¯æ‹¥æœ‰ main æ–¹æ³•çš„ç±»ï¼Œæˆ–è€…æ˜¯ appletï¼Œmidletsï¼Œactivities ç­‰ç­‰ã€‚<br><br>1. åœ¨å‹ç¼©é˜¶æ®µï¼Œ<strong>Proguard</strong> ä»è¿™äº› entry points å‡ºå‘ï¼ŒæŸ¥æ‰¾ç¡®è®¤å“ªäº›ç±»å’Œå˜é‡æ˜¯è¢«ä½¿ç”¨çš„ï¼Œæ‰€æœ‰å…¶ä½™çš„ç±»ä»¥åŠå˜é‡éƒ½ä¼šè¢«ä¸¢å¼ƒï¼›<br>2. åœ¨ä¼˜åŒ–é˜¶æ®µï¼Œ<strong>Proguard</strong> è¿›ä¸€æ­¥ä¼˜åŒ–ä»£ç ï¼Œé‚£äº›ä¸æ˜¯ entry points çš„ç±»å’Œæ–¹æ³•å¯ä»¥è¢«è®¾ç½®æˆ privateã€final æˆ–è€… static çš„ï¼Œæ²¡æœ‰è¢«ç”¨åˆ°çš„å‚æ•°ä¼šè¢«ç§»é™¤ï¼Œä¸€äº›æ–¹æ³•ä¹Ÿä¼šè¢«å†…è”ï¼›<br>3. åœ¨æ··æ·†é˜¶æ®µï¼Œ<strong>Proguard</strong> é‡å‘½åé‚£äº›é entry points çš„ç±»å’Œæˆå‘˜å˜é‡ï¼Œåœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œéƒ½ä¼šä¿æŒå®ƒä»¬çš„åå­—ä¸å˜ï¼›<br>4. é¢„éªŒè¯é˜¶æ®µæ˜¯å”¯ä¸€ä¸€ä¸ªä¸éœ€è¦çŸ¥é“ entry points çš„é˜¶æ®µï¼›<br><br>### åå°„<br>è‡ªåŠ¨å¤„ç†ä»£ç åœ¨é¢å¯¹åå°„å’Œè‡ªçœæ—¶éƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ã€‚åœ¨ä½¿ç”¨<strong>Proguard</strong> çš„æ—¶å€™ï¼Œé‚£äº›ä¼šè¢«åŠ¨æ€è°ƒç”¨ï¼ˆå³é€šè¿‡åå­—è°ƒç”¨ï¼‰çš„ç±»å’Œå˜é‡éƒ½åº”è¯¥è¢«æ ‡è®°ä¸º entry pointsã€‚ä¸¾ä¸ªğŸŒ° ï¼š<code>Class.forName()</code>å¯èƒ½ä¼šæŒ‡å‘ä»»ä½•çš„è¿è¡Œæ—¶çš„ç±»ï¼Œä¸å¤ªå¯èƒ½çŸ¥é“å“ªäº›ç±»åº”è¯¥ä¿æŒåŸæ¥çš„åå­—ä»¥ä¾›è¿™ä¸ªæ–¹æ³•è°ƒç”¨ï¼ˆç±»åå¯èƒ½æ¥æºäºä»»ä½•åœ°æ–¹ï¼‰ã€‚å› æ­¤å¼€å‘è€…å°±å¿…é¡»åœ¨é…ç½®æ–‡ä»¶ä¸­é€šè¿‡<code>-keep</code>æŒ‡å®šè¿™ä¸ªç±»ã€‚<br><br>ä½†æ˜¯ï¼Œ<strong>Proguard</strong>ä¼šè‡ªåŠ¨æ¢æµ‹å¹¶å¤„ç†ä»¥ä¸‹æƒ…å†µï¼š<br><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»¥ä¸‹ç±»åæˆ–è€…å˜é‡åéƒ½æ˜¯é€šè¿‡å­—ç¬¦ä¸²å†™æ­»ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªéšæ—¶å¯ä»¥æ”¹å˜çš„å˜é‡</span></span><br><span class="line">Class.forName(<span class="string">"SomeClass"</span>)</span><br><span class="line">SomeClass.class</span><br><span class="line">SomeClass.class.getField(<span class="string">"someField"</span>)</span><br><span class="line">SomeClass.class.getDeclaredField(<span class="string">"someField"</span>)</span><br><span class="line">SomeClass.class.getMethod(<span class="string">"someMethod"</span>, <span class="keyword">new</span> Class[] &#123;&#125;)</span><br><span class="line">SomeClass.class.getMethod(<span class="string">"someMethod"</span>, <span class="keyword">new</span> Class[] &#123; A.class &#125;)</span><br><span class="line">SomeClass.class.getMethod(<span class="string">"someMethod"</span>, <span class="keyword">new</span> Class[] &#123; A.class, B.class &#125;)</span><br><span class="line">SomeClass.class.getDeclaredMethod(<span class="string">"someMethod"</span>, <span class="keyword">new</span> Class[] &#123;&#125;)</span><br><span class="line">SomeClass.class.getDeclaredMethod(<span class="string">"someMethod"</span>, <span class="keyword">new</span> Class[] &#123; A.class &#125;)</span><br><span class="line">SomeClass.class.getDeclaredMethod(<span class="string">"someMethod"</span>, <span class="keyword">new</span> Class[] &#123; A.class, B.class &#125;)</span><br><span class="line">AtomicIntegerFieldUpdater.newUpdater(SomeClass.class, <span class="string">"someField"</span>)</span><br><span class="line">AtomicLongFieldUpdater.newUpdater(SomeClass.class, <span class="string">"someField"</span>)</span><br><span class="line">AtomicReferenceFieldUpdater.newUpdater(SomeClass.class, SomeType.class, <span class="string">"someField"</span>)</span><br></pre></td></tr></table></figure>
<p>ç±»åæˆ–è€…å˜é‡çš„åå­—å½“ç„¶å¯èƒ½ä¸åŒï¼Œä½†æ˜¯è¿™ç§æ„å»ºæ¨¡å¼<strong>Proguard</strong>æ˜¯å¯ä»¥è¯†åˆ«çš„ï¼Œå› æ­¤é€šè¿‡ä»¥ä¸Šæ–¹å¼å¼•ç”¨çš„ç±»ä»¥åŠå˜é‡åœ¨å‹ç¼©é˜¶æ®µä¼šè¢«ä¿ç•™ï¼Œè€ŒStringå‚æ•°(æŒ‡çš„æ˜¯è¿™äº›æ–¹æ³•çš„å‚æ•°)ä¼šåœ¨æ··æ·†é˜¶æ®µè¢«æ›¿æ¢ã€‚</p>
<blockquote>
<p>å³<strong>Proguard</strong>ä¼šè¯†åˆ«ä¸€äº›æ¨¡å¼ä¸‹å¯¹ç±»å’Œå˜é‡çš„å¼•ç”¨ï¼Œå¹¶æœºæ™ºçš„åˆ¤æ–­å‡ºå“ªäº›ç±»å’Œå˜é‡éœ€è¦ä¿ç•™æˆ–è€…æ›¿æ¢ã€‚</p>
</blockquote>
<p>å¦å¤–ï¼Œ<strong>Proguard</strong>ä¼šå¯¹ä¿ç•™å“ªäº›ç±»æ˜¯æœ‰å¿…è¦çš„ç»™å‡ºæ„è§ã€‚ä¸¾ä¸ªğŸŒ°ï¼š<strong>Proguard</strong>ä¼šæ³¨æ„åˆ°å¦‚ä¸‹çš„æ„å»ºè¿‡ç¨‹:<code>(SomeClass)Class.forName(variable).newInstance()</code>ï¼Œè¿™æœ‰å¯èƒ½æ„å‘³ç€<code>SomeClass</code>è¿™ä¸ªç±»/æ¥å£ä»¥åŠå®ƒçš„å®ç°éƒ½åº”è¯¥è¢«ä¿ç•™ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œå¹¶ä¸å±äºå‰é¢è¯´åˆ°çš„<strong>Proguard</strong>å¯ä»¥è‡ªåŠ¨è¯†åˆ«çš„æ¨¡å¼ï¼‰ã€‚</p>
<blockquote>
<p>å¸¦æœ‰åå°„çš„ä»£ç è¿˜æ˜¯è¦å¤šåŠ å°å¿ƒã€‚</p>
</blockquote>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ä½¿ç”¨<strong>Proguard</strong>é€šå¸¸éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œé’ˆå¯¹ä»¥ä¸Šæ¯ä¸€ä¸ªæ­¥éª¤ï¼Œ<strong>Proguard</strong>éƒ½æä¾›äº†ä¸°å¯Œçš„é…ç½®é¡¹ï¼Œå…·ä½“çš„é…ç½®é€‰é¡¹<a href="http://proguard.sourceforge.net/manual/usage.html" target="_blank" rel="noopener">è¿™é‡Œ</a>å¯ä»¥æŸ¥è¯¢ï¼ŒåŒæ—¶ä¹Ÿæœ‰å¾ˆå¤š<a href="http://proguard.sourceforge.net/manual/examples.html" target="_blank" rel="noopener">ä¾‹å­</a>å¯ä»¥å‚è€ƒã€‚å¦å¤–<strong>Proguard</strong>è¿˜æœ‰ä¸€ä¸ªGUIç»„ä»¶å¯ä»¥ä½¿ç”¨ï¼Œ<a href="http://proguard.sourceforge.net/manual/gui.html" target="_blank" rel="noopener">è¿™é‡Œ</a>å¯æŸ¥çœ‹è¯¦ç»†ã€‚</p>
<p>é‡åˆ°é—®é¢˜å¯ä»¥åœ¨<a href="http://proguard.sourceforge.net/manual/troubleshooting.html" target="_blank" rel="noopener">å®˜ç½‘çš„é—®é¢˜åˆ—è¡¨</a>é‡Œé¢æœç´¢ä¸€ä¸‹ã€‚</p>
<h4 id="å…³äºkeep"><a href="#å…³äºkeep" class="headerlink" title="å…³äºkeep"></a>å…³äºkeep</h4><p>keepé€‰é¡¹ï¼Œæ€»å…±æœ‰ä»¥ä¸‹å‡ ç§:</p>
<table>
<thead>
<tr>
<th>Keep</th>
<th>From being removed or renamed</th>
<th>From being renamed</th>
</tr>
</thead>
<tbody>
<tr>
<td>Classes and class members</td>
<td>-keep</td>
<td>-keepnames</td>
</tr>
<tr>
<td>Class members only</td>
<td>-keepclassmembers</td>
<td>-keepclassmembernames</td>
</tr>
<tr>
<td>Classes and class members, if class members present</td>
<td>-keepclasseswithmembers</td>
<td>-keepclasseswithmembernames</td>
</tr>
</tbody>
</table>
<p>å¦‚æœä¸ç¡®è®¤ä½¿ç”¨å“ªä¸€ä¸ªå‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨<code>-keep</code>ï¼šè¿™ä¼šä¿è¯æŒ‡å®šçš„ç±»ä»¥åŠç±»æˆå‘˜ä¸ä¼šåœ¨å‹ç¼©é˜¶æ®µè¢«ç§»é™¤æ‰ï¼Œåœ¨æ··æ·†é˜¶æ®µä¸ä¼šè¢«é‡å‘½åã€‚</p>
<blockquote>
<p>ã€æ³¨æ„ï¼ï¼ã€‘  </p>
<ol>
<li>å¦‚æœæŒ‡å®šäº†ä¸€ä¸ªç±»è€Œæ²¡æœ‰æŒ‡å®škeepå®ƒçš„ç±»æˆå‘˜ï¼Œé‚£ä¹ˆ<strong>Proguard</strong>ä»…ä»…ä¼šä¿ç•™ç±»ä»¥åŠå®ƒçš„æ— å‚æ„é€ æ–¹æ³•ä½œä¸ºentry pointsï¼Œå®ƒä»ç„¶å¯èƒ½ä¼šç§»é™¤ã€ä¼˜åŒ–æˆ–è€…æ··æ·†å®ƒçš„ç±»æˆå‘˜ï¼›</li>
<li>å¦‚æœæŒ‡å®šäº†ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆ<strong>Proguard</strong>åªä¼šä¿ç•™æ–¹æ³•ä¸ºentry pointsï¼Œå®ƒçš„ä»£ç ä»ç„¶å¯èƒ½è¢«ä¼˜åŒ–æˆ–è€…ä¿®æ”¹ï¼›</li>
</ol>
</blockquote>
<h4 id="Class-Specifications"><a href="#Class-Specifications" class="headerlink" title="Class Specifications"></a>Class Specifications</h4><p><code>keep</code>åé¢è‚¯å®šè·Ÿçš„æ˜¯ä¸€ä¸ªç±»æˆ–è€…ç±»æˆå‘˜çš„æè¿°ç¬¦ï¼Œä»è€Œè¡¨è¾¾<code>keep</code>åº”è¯¥åº”ç”¨åœ¨å“ªäº›åœ°æ–¹ã€‚è¿™ä¸ªæè¿°ç¬¦æ˜¯æœ‰è§„èŒƒçš„ï¼ˆæˆ–è€…ç§°ä¸ºæ¨¡æ¿ï¼‰ï¼Œå³Class Specificationsã€‚</p>
<p>å®ƒçš„æ ¼å¼å¦‚ä¸‹:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">final</span>|<span class="keyword">abstract</span>|@ ...] [!]<span class="class"><span class="keyword">interface</span>|<span class="title">class</span>|<span class="title">enum</span> <span class="title">classname</span></span></span><br><span class="line">    [extends|implements [@annotationtype] classname]</span><br><span class="line">[&#123;</span><br><span class="line">    [<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">private</span>|<span class="keyword">protected</span>|<span class="keyword">static</span>|<span class="keyword">volatile</span>|<span class="keyword">transient</span> ...] &lt;fields&gt; |</span><br><span class="line">                                                                      (fieldtype fieldname);</span><br><span class="line">    [<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">private</span>|<span class="keyword">protected</span>|<span class="keyword">static</span>|<span class="keyword">synchronized</span>|<span class="keyword">native</span>|<span class="keyword">abstract</span>|<span class="keyword">strictfp</span> ...] &lt;methods&gt; |</span><br><span class="line">                                                                                           &lt;init&gt;(argumenttype,...) |</span><br><span class="line">                                                                                           classname(argumenttype,...) |</span><br><span class="line">                                                                                           (<span class="function">returntype <span class="title">methodname</span><span class="params">(argumenttype,...)</span>)</span>;</span><br><span class="line">    [<span class="meta">@annotationtype</span>] [[!]<span class="keyword">public</span>|<span class="keyword">private</span>|<span class="keyword">protected</span>|<span class="keyword">static</span> ... ] *;</span><br><span class="line">    ...</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
<p>æ ¼å¼é‡Œé¢æ¶‰åŠåˆ°ä¸€äº›ç¬¦å·ï¼Œè§£é‡Šå¦‚ä¸‹:</p>
<table>
<thead>
<tr>
<th>ç¬¦å·</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>[]</td>
<td>å¯é€‰</td>
</tr>
<tr>
<td>â€¦</td>
<td>å‰é¢åˆ—å‡ºçš„é€‰é¡¹å¯èƒ½ä»¥ä»»æ„æ•°é‡å‡ºç°</td>
</tr>
<tr>
<td>\</td>
<td></td>
<td>éš”ç¦»ä¸€ç»„å¯é€‰é¡¹</td>
</tr>
<tr>
<td>()</td>
<td>æŠŠæŸä¸€å—è¯´æ˜ç»„åˆåˆ°ä¸€å—</td>
</tr>
</tbody>
</table>
<p><code>class</code>å…³é”®å­—æŒ‡å‘ä»»ä½•çš„æ¥å£æˆ–è€…ç±»ï¼Œ<code>interface</code>åªæŒ‡å‘æ¥å£ã€‚<code>enum</code>åªæŒ‡å‘æšä¸¾ç±»ï¼Œ<code>interface</code>æˆ–è€…<code>enmu</code>åŠ ä¸Š<code>!</code>è¡¨ç¤ºéæ¥å£æˆ–è€…éç±»ã€‚</p>
<p>æ¯ä¸€ä¸ªç±»éƒ½å¿…é¡»ä»¥å…¨é™å®šåå‡ºç°ï¼Œæ¯”å¦‚<code>java.lang.String</code>ï¼Œå†…éƒ¨ç±»åˆ™ä»¥<strong>$</strong>åˆ†å‰²ï¼Œæ¯”å¦‚<code>java.lang.Thread$State</code>ï¼Œç±»åçš„è¡¨è¾¾å¯ä»¥å¸¦æœ‰æ­£åˆ™æè¿°:</p>
<table>
<thead>
<tr>
<th>ç¬¦å·</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>?</td>
<td>åŒ¹é…ä»»ä½•ä¸€ä¸ªå•ä¸€å­—ç¬¦ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬åŒ…ååˆ†å‰²ç¬¦ï¼Œå³<code>.</code>ï¼Œæ¯”å¦‚<code>mypackage.Test?</code>åŒ¹é…<code>mypackage.Test1</code>ï¼Œä½†æ˜¯ä¸åŒ¹é…<code>mypackage.Test12</code></td>
</tr>
<tr>
<td>*</td>
<td>åŒ¹é…ç±»åçš„ä»»ä½•ä¸€éƒ¨åˆ†ï¼Œä½†ä¸åŒ…æ‹¬åŒ…ååˆ†éš”ç¬¦ï¼Œå³<code>.</code>ï¼Œæ¯”å¦‚<code>mypackage.*Test*</code>åŒ¹é…<code>mypackage.Test</code>å’Œ<code>mypackage.YourTestApplication</code>ï¼Œä½†æ˜¯ä¸åŒ¹é…<code>mypackage.mysubpackage.MyTest</code>ï¼Œæˆ–è€…æ›´ç®€å•çš„è¯´ï¼Œ<code>mypackage.*</code>åŒ¹é…<code>mypackage</code>ä¸‹é¢çš„æ‰€æœ‰ç±»ï¼Œä½†ä¸åŒ…æ‹¬å­packageä¸‹é¢çš„ç±»</td>
</tr>
<tr>
<td>**</td>
<td>åŒ¹é…ç±»åçš„ä»»ä½•ä¸€ä¸ªéƒ¨åˆ†ï¼Œå¯ä»¥åŒ…å«ä»»ä½•æ•°é‡çš„åŒ…ååˆ†éš”ç¬¦ï¼Œå³<code>.</code>ï¼Œæ¯”å¦‚<code>**.Test</code>åŒ¹é…é™¤äº†æ ¹åŒ…ä¸‹é¢çš„æ‰€æœ‰çš„åŒ…ä¸­çš„<code>Test</code>ç±»ï¼Œ<code>mypackage.**</code>åŒ¹é…<code>mypackage</code>åŒ…ä»¥åŠå­åŒ…ä¸‹é¢çš„æ‰€æœ‰ç±»ã€‚</td>
</tr>
</tbody>
</table>
<p>å¦å¤–ï¼Œå•ç‹¬çš„<code>*</code>å¯ä»¥è¡¨ç¤ºä»»ä½•ç±»ã€‚</p>
<p><code>extends</code>å’Œ<code>implements</code>é€šå¸¸ç”¨äºé™å®šç±»ï¼Œç›®å‰å®ƒä»¬æ˜¯ç­‰æ•ˆçš„ï¼Œç”¨äºè¡¨è¿°åªæœ‰ç»§æ‰¿/å®ç°æŸä¸ªç±»/æ¥å£çš„ç±»ï¼Œä½†æ˜¯è¿™ä¸ªæ¥å£/ç±»æœ¬èº«ä¸åœ¨è¿™ä¸ªæè¿°ä»¥å†…ã€‚</p>
<p><code>@</code>æè¿°ç¬¦ç”¨äºé™å®šå“ªäº›ä½¿ç”¨ç‰¹å®šçš„æ³¨è§£æè¿°çš„ç±»/ç±»æˆå‘˜ï¼Œ<code>annotationtype</code>çš„æè¿°å’Œç±»åä¸€è‡´ã€‚</p>
<p>å˜é‡å’Œæ–¹æ³•çš„æè¿°å’ŒJavaä¸­çš„å¾ˆåƒï¼Œé™¤äº†æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸åŒ…æ‹¬å‚æ•°åï¼ˆç±»ä¼¼äºJava Docä¸­çš„è¡¨è¿°ï¼‰ï¼Œæè¿°ç¬¦ä¸­å¯ä»¥åŒ…å«ä»¥ä¸‹é€šé…ç¬¦ï¼š</p>
<ol>
<li><strong><code>&lt;init&gt;</code></strong> åŒ¹é…ä»»ä½•ä¸€ä¸ªæ„é€ å‡½æ•°ï¼›</li>
<li><strong><code>&lt;fields&gt;</code></strong> åŒ¹é…ä»»ä½•ä¸€ä¸ªå˜é‡ï¼›</li>
<li><strong><code>&lt;methods&gt;</code></strong> åŒ¹é…ä»»ä½•çš„æ–¹æ³•ï¼›</li>
<li><strong><code>*</code></strong> åŒ¹é…ä»»ä½•çš„å˜é‡å’Œæ–¹æ³•ï¼› </li>
</ol>
<p>ä»¥ä¸Šè¿™äº›æè¿°ä¸åŒ…å«ä»»ä½•çš„è¿”å›å€¼ï¼Œåªæœ‰<code>&lt;init&gt;</code>æœ‰ä¸€ä¸ªå‚æ•°åˆ—è¡¨ã€‚å˜é‡å’Œæ–¹æ³•åå­—å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥åŒ…å«<code>?</code>å’Œ<code>*</code>ï¼Œå«ä¹‰å’Œå‰é¢ä¸€è‡´ï¼Œæè¿°ç¬¦ä¸­çš„ç±»å‹ä¹Ÿå¯ä»¥åŒ…å«ä»¥ä¸‹é€šé…ç¬¦ï¼š</p>
<ol>
<li><strong><code>%</code></strong> åŒ¹é…ä»»ä½•ä¸€ä¸ªåŸå§‹ç±»å‹ï¼ˆbooleanã€intç­‰ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬voidï¼‰ï¼›</li>
<li><strong><code>?</code></strong> åœ¨ç±»ï¼ˆæ¯”å¦‚å‚æ•°ã€è¿”å›å€¼ï¼‰åä¸­åŒ¹é…ä»»ä½•ä¸€ä¸ªå­—ç¬¦ï¼›</li>
<li><strong><code>*</code></strong> ä¹Ÿæ˜¯ç”¨äºç±»åï¼Œå’Œå‰é¢ç±»åçš„æè¿°ä¸­å…³äº<code>*</code>çš„æè¿°ä¸€è‡´ï¼›</li>
<li><strong><code>**</code></strong> ä¹Ÿæ˜¯ç”¨äºç±»åï¼Œå’Œå‰é¢ç±»åçš„æè¿°ä¸­å…³äº<code>**</code>çš„æè¿°ä¸€è‡´ï¼›</li>
<li><strong><code>***</code></strong> åŒ¹é…ä»»ä½•ç±»å‹ï¼šåŸå§‹ç±»å‹ã€éåŸå§‹ç±»å‹ã€æ•°ç»„ç­‰ï¼›</li>
<li><strong><code>Â·Â·Â·</code></strong> åŒ¹é…ä»»ä½•æ•°é‡çš„ä»»ä½•ç±»å‹å‚æ•°ï¼›</li>
</ol>
<p>è¦æ³¨æ„: <code>?</code>ã€<code>*</code>å’Œ<code>**</code>æ°¸è¿œä¸ä¼šåŒ¹é…åŸå§‹ç±»å‹ï¼Œåªæœ‰<code>***</code>å¯ä»¥åŒ¹é…ä¸Šä»»ä½•ç»´åº¦çš„æ•°ç»„ã€‚ä¸¾ä¸ªä¾‹å­ï¼š<code>** get*()</code>åŒ¹é…<code>java.lang.Object getObject()</code>ï¼Œä½†æ˜¯ä¸ä¼šåŒ¹é…<code>float getFloat()</code>æˆ–è€…<code>java.lang.Object[] getObjects()</code>ã€‚</p>
<p>æ„é€ å‡½æ•°æ˜¯å¯ä»¥ç›´æ¥åªç”¨ç±»åæˆ–è€…å…¨é™å®šç±»åè¿›è¡Œæè¿°çš„ï¼Œå› ä¸ºåœ¨Javaä¸­ï¼Œæ„é€ å‡½æ•°æœ‰å‚æ•°åˆ—è¡¨ï¼Œå´æ²¡æœ‰è¿”å›å€¼ã€‚</p>
<p>ç±»å’Œå˜é‡è®¿é—®æ§åˆ¶ç¬¦é€šå¸¸æ˜¯ç”¨æ¥ç»™æ›´ä¸¥æ ¼çš„é™åˆ¶é€šé…ç¬¦â€”â€”ç±»å’Œå˜é‡å¿…é¡»æœ‰ä¸€è‡´çš„è®¿é—®æ§åˆ¶ç¬¦ï¼ŒåŒæ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>!</code>æ¥è¡¨ç¤ºä¸èƒ½è®¾ç½®è¿™æ ·çš„è®¿é—®æ§åˆ¶ç¬¦ã€‚</p>
<p>Proguardç”šè‡³æ”¯æŒåªæœ‰ç¼–è¯‘å™¨æ‰å¯ä»¥è®¾ç½®çš„æ§åˆ¶ç¬¦ï¼š<code>synthetic</code>ï¼Œ<code>bridge</code>å’Œ<code>varargs</code>ã€‚</p>
<blockquote>
<p>ã€æ³¨ã€‘ä»¥ä¸Šç¿»è¯‘è‡ª<a href="http://proguard.sourceforge.net/manual/usage.html" target="_blank" rel="noopener">å®˜ç½‘Usage</a>ã€‚å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿æŒ‡å‡ºã€‚</p>
</blockquote>
<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><p>åœ¨Androidä¸Šï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å¯ç”¨<strong>Proguard</strong>:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">true</span></span><br><span class="line">            shrinkResources <span class="keyword">true</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(â€˜proguard-android.txt<span class="string">'),</span></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="string">                    '</span>proguard-rules.pro<span class="string">'</span></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="string">        &#125;</span></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="string">    &#125;</span></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="string">    ...</span></span></span></span><br><span class="line"><span class="function"><span class="params"><span class="string">&#125;</span></span></span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡<code>minifyEnabled</code>çš„è®¾ç½®ï¼Œå¯ä»¥å¯¹ä»£ç è¿›è¡Œå‹ç¼©ä¼˜åŒ–ï¼›é€šè¿‡<code>shrinkResources</code>çš„è®¾ç½®ï¼Œå¯ä»¥å¯¹ä»£ç è¿›è¡Œèµ„æºä¼˜åŒ–ï¼›<code>proguardFiles</code>è®¾ç½®åˆ™ç”¨äºæä¾›å‹ç¼©è§„åˆ™ï¼š</p>
<ol>
<li><code>getDefaultProguardFile(â€˜proguard-android.txt&#39;)</code>æ–¹æ³•ä¼šä»Android SDKä¸‹çš„<code>tools/proguard/</code>ç›®å½•è¯»å–<strong>Proguard</strong>çš„é»˜è®¤é…ç½®ï¼Œåœ¨è¿™ä¸ªç›®å½•ä¸‹é¢è¿˜æœ‰ä¸€ä¸ªæ–‡ä»¶<code>proguard-android-optimize.txt</code>ï¼Œå®ƒä¸ä»…åŒ…å«ç›¸åŒçš„è§„åˆ™ï¼Œè€Œä¸”ä¼šåœ¨å­—èŠ‚ç å±‚çº§å¯¹APKè¿›è¡Œåˆ†æï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–APKæ–‡ä»¶ï¼Œå¯ä»¥å°è¯•ï¼›</li>
<li><code>proguard-rules.pro</code>æ–‡ä»¶æ˜¯å¼€å‘è€…è‡ªå®šä¹‰è§„åˆ™çš„åœ°æ–¹ï¼Œè¯¥æ–‡ä»¶é»˜è®¤ä¸<code>build.gradle</code>æ–‡ä»¶åŒçº§ï¼›</li>
</ol>
<p>èµ„æºä¼˜åŒ–åœ¨ä»£ç å‹ç¼©ä¹‹åï¼Œå› ä¸ºåªæœ‰ç§»é™¤ä¸éœ€è¦çš„ä»£ç ä¹‹åæ‰å¯ä»¥åˆ¤æ–­å“ªäº›èµ„æºæ— ç”¨ã€‚</p>
<blockquote>
<p>ç›®å‰èµ„æºä¼˜åŒ–å¯¹äº<code>values/</code>æ–‡ä»¶å¤¹ä¸‹é¢çš„èµ„æºä¸åšç§»é™¤ï¼Œå› ä¸ºAAPTï¼ˆAndroid Asset Packaging Toolï¼‰ä¸å…è®¸ã€‚</p>
</blockquote>
<p>ä»¥ä¸‹è¿™ç§æ–¹å¼å¯ä»¥ä¸ºæŸç§ç‰¹æ®Šçš„build variantæ·»åŠ æ–°çš„æ··æ·†è§„åˆ™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled <span class="keyword">true</span></span><br><span class="line">            <span class="function">proguardFiles <span class="title">getDefaultProguardFile</span><span class="params">(<span class="string">'proguard-android.txt'</span>)</span>,</span></span><br><span class="line"><span class="function">                   'proguard-rules.pro'</span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">    productFlavors </span>&#123;</span><br><span class="line">        flavor1 &#123;</span><br><span class="line">        &#125;</span><br><span class="line">        flavor2 &#123;</span><br><span class="line">            proguardFile <span class="string">'flavor2-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Build Type  + Product Flavor = Build Variant</p>
<p>æ³¨æ„ï¼Œè¿™é‡Œåœ¨flavor2ä¸­è®¾ç½®çš„é…ç½®æ–‡ä»¶ä¸buildTypesä¸­çš„æ˜¯è¿½åŠ å…³ç³»ï¼Œä¸æ˜¯æ›¿ä»£å…³ç³»ã€‚</p>
</blockquote>
<h3 id="è¾“å‡ºæ–‡ä»¶"><a href="#è¾“å‡ºæ–‡ä»¶" class="headerlink" title="è¾“å‡ºæ–‡ä»¶"></a>è¾“å‡ºæ–‡ä»¶</h3><p>æ··æ·†åï¼Œä¼šåœ¨<code>&lt;module-name&gt;/build/outputs/mapping/release/</code>ç›®å½•ä¸‹è¾“å‡ºä¸‹é¢çš„æ–‡ä»¶ï¼š</p>
<ol>
<li><strong>dump.txt</strong> æè¿°apkæ–‡ä»¶ä¸­æ‰€æœ‰ç±»æ–‡ä»¶é—´çš„å†…éƒ¨ç»“æ„ï¼›</li>
<li><strong>mapping.txt</strong> æä¾›äº†åŸå§‹çš„ç±»ï¼Œæ–¹æ³•ï¼Œå’Œå­—æ®µåä¸æ··æ·†åä»£ç ä¹‹é—´çš„æ˜ å°„ï¼›</li>
<li><strong>seeds.txt</strong> åˆ—å‡ºäº†æœªè¢«æ··æ·†çš„ç±»å’Œæˆå‘˜ï¼›</li>
<li><strong>usage.txt</strong> åˆ—å‡ºäº†ä»apkä¸­åˆ é™¤çš„ä»£ç ï¼›</li>
</ol>
<h3 id="å®šä¹‰ä»£ç ä¿ç•™"><a href="#å®šä¹‰ä»£ç ä¿ç•™" class="headerlink" title="å®šä¹‰ä»£ç ä¿ç•™"></a>å®šä¹‰ä»£ç ä¿ç•™</h3><p>æŸäº›æƒ…å†µä¸‹ï¼Œä½¿ç”¨é»˜è®¤çš„<strong>Proguard</strong>é…ç½®æ–‡ä»¶<code>proguard-android.txt</code>å°±è¶³å¤Ÿäº†ï¼Œ<strong>Proguard</strong>ä»…ä»…ä¼šç§»é™¤æ‰€æœ‰çš„æœªä½¿ç”¨ä»£ç ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µ<strong>Proguard</strong>å¾ˆéš¾åˆ¤æ–­ï¼Œå¯èƒ½ä¼šç§»é™¤ä¸€äº›ä¸è¯¥è¢«ç§»é™¤çš„ä»£ç ï¼Œæ¯”å¦‚:</p>
<ol>
<li>ä¸€ä¸ªä»…ä»…åœ¨<code>AndroidManifest.xml</code>æ–‡ä»¶ä¸­ä½¿ç”¨çš„ç±»ï¼›</li>
<li>ä»JNIè°ƒç”¨çš„æ–¹æ³•ï¼›</li>
<li>è¿è¡Œæ—¶æ“ä½œçš„ä»£ç ï¼ˆæ¯”å¦‚åå°„å’Œè‡ªçœï¼‰ï¼›</li>
</ol>
<p>è¿™éƒ¨åˆ†ä»£ç éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸Šæåˆ°çš„è¾“å‡ºæ–‡ä»¶è¾…åŠ©æ’æŸ¥ã€‚å¯ä»¥ä½¿ç”¨ä¸€ä¸‹é…ç½®è¯­å¥è¿›è¡Œä»£ç ä¿ç•™:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-keep <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span></span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§åŠæ³•å°±æ˜¯ä½¿ç”¨<code>@Keep</code>æ³¨è§£ï¼Œåœ¨ç±»ä¸Šä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œæ•´ä¸ªç±»éƒ½ä¼šä¿æŒåŸæ ·ï¼Œåœ¨æ–¹æ³•/å˜é‡ä¸Šä½¿ç”¨è¯¥æ³¨è§£ï¼Œåˆ™è¢«æ³¨è§£çš„æ–¹æ³•/å˜é‡ä»¥åŠå®ƒä»¬çš„æ‰€åœ¨ç±»éƒ½ä¼šä¿æŒåŸå°ä¸åŠ¨ï¼Œä¸è¿‡è¿™ä¸ªä½¿ç”¨è¿™ä¸ªæ³¨è§£éœ€è¦æ·»åŠ <code>Annotations Support Library</code>ä¾èµ–ã€‚</p>
<p>å…³äºèµ„æºçš„ä¼˜åŒ–ï¼Œ<a href="http://developer.android.com/intl/zh-cn/tools/help/proguard.html" target="_blank" rel="noopener">å®˜ç½‘</a>ä¸Šæœ‰æ¯”è¾ƒè¯¦ç»†çš„æè¿°ï¼Œæ¯”è¾ƒå¤æ‚ï¼Œè¿™é‡Œä¸æ•´ç†äº†ã€‚åŒä»£ç ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥å¯¹èµ„æºè¿›è¡Œä¿ç•™ï¼Œä½†æ˜¯å¯¹äºé‡å¤çš„èµ„æºã€å¤šè¯­è¨€èµ„æºã€é€šè¿‡Idå¼•ç”¨çš„èµ„æºéƒ½æœ‰å¯é€‰çš„é…ç½®ã€‚</p>
<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªé…ç½®ä¾‹å­:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">-injars      bin/classes</span><br><span class="line">-injars      libs</span><br><span class="line">-outjars     bin/classes-processed.jar</span><br><span class="line">-libraryjars /usr/local/java/android-sdk/platforms/android-<span class="number">9</span>/android.jar</span><br><span class="line"></span><br><span class="line">-dontpreverify</span><br><span class="line">-repackageclasses <span class="string">''</span></span><br><span class="line">-allowaccessmodification</span><br><span class="line">-optimizations !code/simplification/arithmetic</span><br><span class="line">-keepattributes *Annotation*</span><br><span class="line"></span><br><span class="line">-keep <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Activity</span></span></span><br><span class="line"><span class="class">-<span class="title">keep</span> <span class="title">public</span> <span class="title">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Application</span></span></span><br><span class="line"><span class="class">-<span class="title">keep</span> <span class="title">public</span> <span class="title">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">app</span>.<span class="title">Service</span></span></span><br><span class="line"><span class="class">-<span class="title">keep</span> <span class="title">public</span> <span class="title">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">content</span>.<span class="title">BroadcastReceiver</span></span></span><br><span class="line"><span class="class">-<span class="title">keep</span> <span class="title">public</span> <span class="title">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">content</span>.<span class="title">ContentProvider</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">-<span class="title">keep</span> <span class="title">public</span> <span class="title">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">view</span>.<span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> &lt;init&gt;(android.content.Context);</span><br><span class="line">    <span class="keyword">public</span> &lt;init&gt;(android.content.Context, android.util.AttributeSet);</span><br><span class="line">    <span class="keyword">public</span> &lt;init&gt;(android.content.Context, android.util.AttributeSet, <span class="keyword">int</span>);</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> set*(...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-keepclasseswithmembers <span class="class"><span class="keyword">class</span> * </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> &lt;init&gt;(android.content.Context, android.util.AttributeSet);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-keepclasseswithmembers <span class="class"><span class="keyword">class</span> * </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> &lt;init&gt;(android.content.Context, android.util.AttributeSet, <span class="keyword">int</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> * <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">content</span>.<span class="title">Context</span> </span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> *(android.view.View);</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> *(android.view.MenuItem);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> * <span class="keyword">implements</span> <span class="title">android</span>.<span class="title">os</span>.<span class="title">Parcelable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> ** CREATOR;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> **.<span class="title">R</span>$* </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;fields&gt;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-keepclassmembers <span class="class"><span class="keyword">class</span> * </span>&#123;</span><br><span class="line">    <span class="meta">@android</span>.webkit.JavascriptInterface &lt;methods&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="åæ··æ·†"><a href="#åæ··æ·†" class="headerlink" title="åæ··æ·†"></a>åæ··æ·†</h3><p>å¯¹äºæ‰“å°å‡ºçš„Crash Logç­‰ä¿¡æ¯ï¼Œå› ä¸ºè¢«æ··æ·†çš„åŸå› ï¼Œå¯¼è‡´è¿™äº›ä¿¡æ¯é˜…è¯»èµ·æ¥éå¸¸å›°éš¾ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥å…·<strong>ç¿»è¯‘</strong>ä¸€ä¸‹è¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›è¡Œ:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">retrace.bat|retrace.sh [-verbose] mapping.txt [&lt;stacktrace_file&gt;]</span><br></pre></td></tr></table></figure>
<p><code>retrace</code>æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œä½äº<code>&lt;sdk-root&gt;/tools/proguard/</code>ç›®å½•ä¸‹é¢(åœ¨Windowsä¸Šæ˜¯<code>retrace.bat</code>ï¼Œåœ¨Mac/Linuxä¸Šæ˜¯<code>retrace.sh</code>ã€‚)ã€‚</p>
<p><a href="http://proguard.sourceforge.net/" target="_blank" rel="noopener">å®˜ç½‘</a>ä¹Ÿæœ‰ç›¸å…³çš„æ–‡æ¡£ï¼Œç‚¹å‡»Retrace Manualä¸‹é¢çš„ä¸‰ä¸ªTabå°±å¯ä»¥çœ‹åˆ°ä»‹ç»ã€ä½¿ç”¨æ–¹å¼ä»¥åŠä¾‹å­ã€‚</p>
<blockquote>
<p>Google Playè‡ªåŠ¨åœ¨æ”¯æŒåæ··æ·†ï¼Œå¯è§<a href="https://support.google.com/googleplay/android-developer/answer/6295281" target="_blank" rel="noopener">å¸®åŠ©ä¸­å¿ƒ</a>ã€‚</p>
</blockquote>
<h2 id="é™åˆ¶"><a href="#é™åˆ¶" class="headerlink" title="é™åˆ¶"></a>é™åˆ¶</h2><p>ä½¿ç”¨<strong>Proguard</strong>çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ä¸€äº›æŠ€æœ¯é—®é¢˜ï¼Œå®ƒä»¬éƒ½å¾ˆå®¹æ˜“è§„é¿æˆ–è€…è§£å†³:</p>
<ol>
<li><strong>Proguard</strong>çš„ä¼˜åŒ–ç®—æ³•ä¼šå‡è®¾è¢«å¤„ç†çš„ä»£ç ä¸ä¼šæ•…æ„æŠ›å‡ºNPE/ArrayIndexOutOfBoundsExceptions/OutOfMemoryErrors/StackOverflowErrorsæ¥è¾¾åˆ°æŸä¸ªç›®çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœ<code>myObject.myMethod()</code>è¿™æ ·çš„æ–¹æ³•è°ƒç”¨å®Œå…¨æ— æ•ˆï¼Œå®ƒå¯èƒ½ä¼šç§»é™¤å®ƒï¼Œå®ƒå¿½ç•¥<code>myObject</code>æ˜¯nullçš„å¯èƒ½æ€§ï¼ˆä¹Ÿå³ï¼šå¿½ç•¥å¼€å‘è€…é€šè¿‡è¿™ç§æ–¹å¼æŠ›å‡ºNPEé”™è¯¯çš„æ„å›¾ï¼‰ã€‚æŸäº›æ—¶å€™è¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼Œä¼˜åŒ–åçš„ä»£ç ä¼šæŠ›å‡ºæ›´å°‘çš„å¼‚å¸¸ã€‚ä½†å¦‚æœè¿™ä¸ªå‡è®¾æ˜¯é”™è¯¯çš„ï¼Œå¼€å‘è€…åº”è¯¥ä½¿ç”¨<code>-dontoptimize</code>å…³é—­ä¼˜åŒ–åŠŸèƒ½ï¼›</li>
<li><strong>Proguard</strong>çš„ä¼˜åŒ–ç®—æ³•ä¹Ÿä¼šå‡è®¾è¢«å¤„ç†çš„ä»£ç ä¸ä¼šæœ‰<code>busy-waiting loops without at least testing on a volatile field</code>(ç¿»è¯‘ä¸å¥½ï¼Œå¤§æ¦‚æ˜¯è¯´é€šè¿‡ä¸€ä¸ªæ— é™å¾ªç¯å»æ£€æµ‹ä¸€ä¸ªévolatileå˜é‡)ï¼Œå› æ­¤å®ƒä¹Ÿä¼šç§»é™¤æ­¤ç±»ä»£ç ã€‚å¦‚æœè¿™é¡¹å‡è®¾æ˜¯é”™è¯¯çš„ï¼Œå¼€å‘è€…åº”è¯¥ä½¿ç”¨<code>-dontoptimize</code>å…³é—­ä¼˜åŒ–åŠŸèƒ½ï¼›</li>
<li>å¦‚æœInput jarså’ŒLibrary jarsåœ¨æœ‰classåœ¨åŒä¸€ä¸ªåŒ…ä¸‹é¢ï¼Œåˆ™æ··æ·†åçš„Output jarsæœ‰å¯èƒ½ä¼šåŒ…å«ä¸€äº›ä¸Library jarsåŒåçš„ç±»æ–‡ä»¶ï¼Œå°¤å…¶å½“Library jarsä¹‹å‰å°±è¢«æ··æ·†è¿‡ã€‚å› æ­¤Input jarså’ŒLibrary jarsä¸åº”è¯¥å…±äº«ä¸€ä¸ªåŒ…ï¼›</li>
</ol>
<h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><p>å…·ä½“è§<a href="http://proguard.sourceforge.net/FAQ.html" target="_blank" rel="noopener">å®˜ç½‘</a>ã€‚è¿™é‡Œæ•´ç†å‡ ä¸ªé‡è¦çš„ç»“è®ºï¼š</p>
<ol>
<li><strong>Proguard</strong>ä¼šè‡ªåŠ¨å¤„ç†<code>Class.forName(&quot;SomeClass&quot;)</code>å’Œ<code>SomeClass.class</code>çš„å¤„ç†æƒ…å†µï¼Œåœ¨å‹ç¼©é˜¶æ®µï¼Œè¿™äº›ç±»ä¼šè¢«ä¿ç•™ï¼Œåœ¨æ··æ·†é˜¶æ®µï¼Œè¿™äº›ç±»ä¹Ÿä¼šè¢«æ›¿æ¢æ‰ï¼›</li>
<li>å¯¹äºèµ„æºã€Stringä»¥åŠæµç¨‹æ§åˆ¶çš„æ··æ·†ï¼Œç›´æ¥çœ‹å®˜ç½‘ï¼›</li>
<li><strong>Proguard</strong>æ”¯æŒå¢é‡å¼æ··æ·†â€”â€”å³æä¾›ä¸€ä¸ªä¹‹å‰çš„mappingæ–‡ä»¶è¿›è¡Œä¸€æ¬¡æ–°çš„æ··æ·†ï¼›</li>
<li><strong>Proguard</strong>å…è®¸è‡ªå®šä¹‰æ··æ·†å­—å…¸ï¼›</li>
</ol>
</div><div class="tags"><a href="/tags/æ€§èƒ½ä¼˜åŒ–/">æ€§èƒ½ä¼˜åŒ–</a><a href="/tags/å·¥å…·/">å·¥å…·</a></div><div class="post-nav"><a href="/2016/05/14/Android-Framewok-Base/" class="pre">Android Frameworkå­¦ä¹ é¢„å¤‡</a><a href="/2016/05/10/Android-Systrace/" class="next">Systrace</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> åˆ†ç±»</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">59</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ReactiveX/">ReactiveX</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/åç«¯/">åç«¯</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å·¥å…·/">å·¥å…·</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/å½±è§†/">å½±è§†</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/æŠ€æœ¯/">æŠ€æœ¯</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ç”µå½±/">ç”µå½±</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> æ ‡ç­¾</i></div><div class="tagcloud"><a href="/tags/Gitbook/" style="font-size: 15px;">Gitbook</a> <a href="/tags/Runtime/" style="font-size: 15px;">Runtime</a> <a href="/tags/è§†å›¾/" style="font-size: 15px;">è§†å›¾</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/æƒé™/" style="font-size: 15px;">æƒé™</a> <a href="/tags/ä»£ç ä¼˜åŒ–/" style="font-size: 15px;">ä»£ç ä¼˜åŒ–</a> <a href="/tags/Framework/" style="font-size: 15px;">Framework</a> <a href="/tags/æ€§èƒ½ä¼˜åŒ–/" style="font-size: 15px;">æ€§èƒ½ä¼˜åŒ–</a> <a href="/tags/å·¥å…·/" style="font-size: 15px;">å·¥å…·</a> <a href="/tags/åˆé›†/" style="font-size: 15px;">åˆé›†</a> <a href="/tags/ADB/" style="font-size: 15px;">ADB</a> <a href="/tags/æºç /" style="font-size: 15px;">æºç </a> <a href="/tags/åç¼–è¯‘/" style="font-size: 15px;">åç¼–è¯‘</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/åŸºç¡€/" style="font-size: 15px;">åŸºç¡€</a> <a href="/tags/æ•ˆç‡/" style="font-size: 15px;">æ•ˆç‡</a> <a href="/tags/MarkDown/" style="font-size: 15px;">MarkDown</a> <a href="/tags/ç”µå½±/" style="font-size: 15px;">ç”µå½±</a> <a href="/tags/Reactive/" style="font-size: 15px;">Reactive</a> <a href="/tags/AIDL/" style="font-size: 15px;">AIDL</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/é©±åŠ¨/" style="font-size: 15px;">é©±åŠ¨</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/æ—¥å¿—/" style="font-size: 15px;">æ—¥å¿—</a> <a href="/tags/äº‹ä»¶/" style="font-size: 15px;">äº‹ä»¶</a> <a href="/tags/ä»£ç è®¾è®¡/" style="font-size: 15px;">ä»£ç è®¾è®¡</a> <a href="/tags/ç½‘ç»œ/" style="font-size: 15px;">ç½‘ç»œ</a> <a href="/tags/æµ‹è¯•/" style="font-size: 15px;">æµ‹è¯•</a> <a href="/tags/Binder/" style="font-size: 15px;">Binder</a> <a href="/tags/Groovy/" style="font-size: 15px;">Groovy</a> <a href="/tags/Loader/" style="font-size: 15px;">Loader</a> <a href="/tags/RAC/" style="font-size: 15px;">RAC</a> <a href="/tags/äº‹ä»¶å¤„ç†/" style="font-size: 15px;">äº‹ä»¶å¤„ç†</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> æœ€è¿‘æ–‡ç« </i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/AIDL-åŸç†åˆ†æ/">AIDL åŸç†åˆ†æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/App-å¯åŠ¨è¿‡ç¨‹/">App å¯åŠ¨è¿‡ç¨‹</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/PMS-è§£æ/">PMS è§£æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/WMS-è§£æ/">WindowManagerService è§£æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/AMS-è§£æ/">AMS è§£æ</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/The-Good-Wife/">The-Good-Wife</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/Black-Sails/">é»‘å¸†</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/29/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/XCode-8-2-1-ClangFormat-æ’ä»¶å®‰è£…/">XCode 8.2.1 ClangFormat æ’ä»¶å®‰è£…</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/SourceTree-åˆ†æ”¯å›¾è°±/">SourceTree åˆ†æ”¯å›¾è°±</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2018 <a href="/." rel="nofollow">èœ—ç‰›å£³.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>