<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="李全民的个人博客"><title>Android开发One Piece | 蜗牛壳</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-65882749-1','auto');ga('send','pageview');</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Android开发One Piece</h1><a id="logo" href="/.">蜗牛壳</a><p class="description">计算机只有 0 和 1 ，但世界是连续的</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Android开发One Piece</h1><div class="post-meta">Feb 27, 2016<span> | </span><span class="category"><a href="/categories/Android/">Android</a></span></div><div class="post-content"><div align="center"><img src="http://7xktd8.com1.z0.glb.clouddn.com/onepiece2.png" height="188" alt="One Piece"></div>

<h2 id="工具相关"><a href="#工具相关" class="headerlink" title="工具相关"></a>工具相关</h2><h3 id="TraceView"><a href="#TraceView" class="headerlink" title="TraceView"></a>TraceView</h3><ol>
<li><a href="http://tech.meituan.com/android_custom_lint.html" target="_blank" rel="noopener">Android自定义Lint实践</a>。看上去很强大的样子，可以用于定制一些工具。</li>
<li><a href="http://laobie.github.io/android/2016/02/14/android-studio-tips.html" target="_blank" rel="noopener">Android Studio 小技巧合集</a>。调试器技巧分类下很有用。</li>
<li><a href="https://segmentfault.com/a/1190000004461614" target="_blank" rel="noopener">Android分享：代码混淆那些事</a>。跟Proguard相关的基本知识，也有一些不错的文章链接。<a id="more"></a>
<h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzA3NTYzODYzMg==&amp;mid=404234343&amp;idx=1&amp;sn=b297b01ee7c656b900417f14a2a0ccae&amp;scene=1&amp;srcid=0303KKfAyLlCyDJT1Sutn26i&amp;key=710a5d99946419d9c72026bcf5c728d9f9fb967dc032ffe2a60669550d6677ace7cadcf6453d69de28540dcbdceefb49&amp;ascene=0&amp;uin=MTYzMjY2MTE1&amp;devicetype=iMac+MacBookPro10%2C1+OSX+OSX+10.11.3+build(15D21" target="_blank" rel="noopener">TRIM：提升磁盘性能，缓解Android卡顿</a>&amp;version=11020201&amp;pass_ticket=VbRCYWXa6oXQkbEbGqIqO1z%2BRQ8XRpmC8IJJVBb2EJ8%3D)。这篇文章提到了Android系统上长期读写文件造成的磁盘碎片化对Android系统流畅度的影响。</li>
</ol>
<blockquote>
<p>Android手机大多采用NAND Flash架构的闪存卡。虽然 NAND Flash 的优点多多，但是为了延长驱动器的寿命，它的读写操作均是以 Page 为单位进行的，但擦除操作却是按 Block 为单位进行的。这会造成“写入放大”（Write Amplification）问题。这一点可以使用TRIM技术解决:</p>
<blockquote>
<p>TRIM 是一条 ATA 指令，由操作系统发送给闪存主控制器，告诉它哪些数据占的地址是“无效”的。在 TRIM 的帮助下，闪存主控制器就可以提前知道哪些 Page 是“无效”的，便可以在适当的时机做出优化，从而改善性能。</p>
</blockquote>
<p>后面用实验证明了这种猜想，以及Android系统确实使用该技术对系统做出了优化，结论如下:</p>
<ol>
<li>在 TRIM 无效的情况下，长期使用 SD 卡，磁盘写入速度会受到明显影响;</li>
<li>TRIM 对因闲置数据块造成的 I/O 性能下降有一定的恢复作用;</li>
<li>大量的读写操作对 SD 卡造成了一定量的不可恢复的损耗;</li>
</ol>
</blockquote>
<ol>
<li><a href="http://blog.csdn.net/UsherFor/article/details/46827587" target="_blank" rel="noopener">如何做到将apk大小减少6M</a>。讲了一组与缩小APK大小相关的优化措施，挺全面。</li>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzI1NjEwMTM4OA==&amp;mid=2651232233&amp;idx=1&amp;sn=03d9858ac451f2768b804d2604a8e12e" target="_blank" rel="noopener">PNG图片压缩对比分析</a>。调研了目前常用的PNG压缩工具和第三方库，在决定使用pngquant的基础上开发Gradle插件，完成PNG的自动打包压缩，非常具有实践性。</li>
</ol>
<h2 id="知识整理"><a href="#知识整理" class="headerlink" title="知识整理"></a>知识整理</h2><ol>
<li><p><a href="https://mp.weixin.qq.com/s?__biz=MzA4MjU5NTY0NA==&amp;mid=404530070&amp;idx=1&amp;sn=e2580b69d6ec73dabf8160216aa6702a&amp;scene=1&amp;srcid=0322dGvv5B4miLg3vt0q2rK2&amp;key=710a5d99946419d9e5ab07eaa09e546952524b770e8a63c46c223b7588209d3a542fe4a0827571ac73b03cb78b404289&amp;ascene=0&amp;uin=MTYzMjY2MTE1&amp;devicetype=iMac+MacBookPro10%2C1+OSX+OSX+10.11.4+build(15E65" target="_blank" rel="noopener">Android Bitmap面面观</a>&amp;version=11020201&amp;pass_ticket=Sqb%2BpOLTrZ0wixoScJ8flYxFV4tOFnBa7NFos1uIG8U%3D)</p>
</li>
<li><p><a href="http://ztelur.github.io/2016/03/16/Android-MotionEvent%E8%AF%A6%E8%A7%A3/" target="_blank" rel="noopener">Android MotionEvent详解</a>。里面有着对Index、Pointer、Id的讨论。</p>
</li>
<li><p><a href="http://jijiaxin89.com/2015/08/30/Android-s-Runtime-Permission/" target="_blank" rel="noopener">Android M 新的运行时权限开发者需要知道的一切</a></p>
</li>
<li><p><a href="http://mp.weixin.qq.com/s?__biz=MzA4MjU5NTY0NA==&amp;mid=404388098&amp;idx=1&amp;sn=8bbbba7692dca68cdda2212dec4d86c0&amp;scene=21#wechat_redirect" target="_blank" rel="noopener">你应该知道的那些Android小经验</a></p>
</li>
<li><p><a href="http://mp.weixin.qq.com/s?__biz=MzA3NTYzODYzMg==&amp;mid=403263974&amp;idx=1&amp;sn=b0315addbc47f3c38e65d9c633a12cd6&amp;scene=4#wechat_redirect" target="_blank" rel="noopener">Android 开发绕不过的坑：你的 Bitmap 究竟占多大内存？</a>。详细探究了关于图片放置在不同分辨率文件夹下面生成Bitmap后所占内存大小的计算方法，清楚明白。</p>
<blockquote>
<p>整理出来的公式分为两部分：</p>
<p>1）内存图片实际的宽高计算：内存宽/高 = (int)(文件实际宽/高 * 屏幕分辨率 / 文件夹分辨率 + 0.5)</p>
<p>2）内存占用计算：内存大小 = 内存宽 <em> 内存高 </em> 每个像素占用值。</p>
<p>每个像素占用值可以参见：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">SkColorTypeBytesPerPixel</span><span class="params">(SkColorType ct)</span> </span>&#123;</span><br><span class="line">&gt;    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">uint8_t</span> gSize[] = &#123;</span><br><span class="line">&gt;     <span class="number">0</span>,  <span class="comment">// Unknown</span></span><br><span class="line">&gt;     <span class="number">1</span>,  <span class="comment">// Alpha_8</span></span><br><span class="line">&gt;     <span class="number">2</span>,  <span class="comment">// RGB_565</span></span><br><span class="line">&gt;     <span class="number">2</span>,  <span class="comment">// ARGB_4444</span></span><br><span class="line">&gt;     <span class="number">4</span>,  <span class="comment">// RGBA_8888</span></span><br><span class="line">&gt;     <span class="number">4</span>,  <span class="comment">// BGRA_8888</span></span><br><span class="line">&gt;     <span class="number">1</span>,  <span class="comment">// kIndex_8</span></span><br><span class="line">&gt;   &#125;;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>粗略的看，<strong>图片占用内存大小与解析格式、存放目录以及手机屏幕密度相关</strong>。</p>
</blockquote>
</li>
<li><p>待补充。</p>
</li>
</ol>
<h2 id="黑科技"><a href="#黑科技" class="headerlink" title="黑科技"></a>黑科技</h2><ol>
<li><a href="https://mp.weixin.qq.com/s?__biz=MzAxNjI3MDkzOQ==&amp;mid=405919721&amp;idx=1&amp;sn=fdad21c0bc74d90e66443d488e8cdc8f&amp;scene=0&amp;key=710a5d99946419d977ba9c54e81b348f298b6edd533df2290bf866f6dc83684af4956d4748ed17fc4b79f57bd5c02431&amp;ascene=0&amp;uin=MTYzMjY2MTE1&amp;devicetype=iMac+MacBookPro10%2C1+OSX+OSX+10.11.3+build(15D21" target="_blank" rel="noopener">一种为 Apk 动态写入信息的方案</a>&amp;version=11020201&amp;pass_ticket=obnYCpEe4OrQ6yNew2Dy2ncIZX%2B8wffXKUYSyIB2KVY%3D)<br>挺有意思的手法，这篇文章基于分享场景介绍了一种动态为APK写入信息的方法——从Zip文件格式入手，在文件尾部插入一小段信息，利用这段信息完成分享场景的完整性。赞！</li>
<li><a href="http://blog.csdn.net/xieyuooo/article/details/7068216" target="_blank" rel="noopener">如何精确地测量java对象的大小-底层instrument API</a>和<a href="http://my.oschina.net/xianggao/blog/362495" target="_blank" rel="noopener">java.lang.Instrument 代理Agent使用</a>。主要介绍了<code>Agent</code>的存在以及Instrument测量Java对象大小的使用方式。</li>
</ol>
</div><div class="tags"><a href="/tags/合集/">合集</a></div><div class="post-nav"><a href="/2016/02/27/Java-threadlocal/" class="pre">ThreadLocal源码剖析</a><a href="/2016/02/26/Android-HandlerThread-And-IntentService/" class="next">HandlerThread &amp; IntentService源码分析</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">59</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ReactiveX/">ReactiveX</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/后端/">后端</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工具/">工具</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/影视/">影视</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/技术/">技术</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/电影/">电影</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Gitbook/" style="font-size: 15px;">Gitbook</a> <a href="/tags/Runtime/" style="font-size: 15px;">Runtime</a> <a href="/tags/视图/" style="font-size: 15px;">视图</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/权限/" style="font-size: 15px;">权限</a> <a href="/tags/代码优化/" style="font-size: 15px;">代码优化</a> <a href="/tags/Framework/" style="font-size: 15px;">Framework</a> <a href="/tags/性能优化/" style="font-size: 15px;">性能优化</a> <a href="/tags/工具/" style="font-size: 15px;">工具</a> <a href="/tags/合集/" style="font-size: 15px;">合集</a> <a href="/tags/ADB/" style="font-size: 15px;">ADB</a> <a href="/tags/源码/" style="font-size: 15px;">源码</a> <a href="/tags/反编译/" style="font-size: 15px;">反编译</a> <a href="/tags/iOS/" style="font-size: 15px;">iOS</a> <a href="/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/tags/Hexo/" style="font-size: 15px;">Hexo</a> <a href="/tags/基础/" style="font-size: 15px;">基础</a> <a href="/tags/效率/" style="font-size: 15px;">效率</a> <a href="/tags/MarkDown/" style="font-size: 15px;">MarkDown</a> <a href="/tags/电影/" style="font-size: 15px;">电影</a> <a href="/tags/Reactive/" style="font-size: 15px;">Reactive</a> <a href="/tags/AIDL/" style="font-size: 15px;">AIDL</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/驱动/" style="font-size: 15px;">驱动</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/日志/" style="font-size: 15px;">日志</a> <a href="/tags/事件/" style="font-size: 15px;">事件</a> <a href="/tags/代码设计/" style="font-size: 15px;">代码设计</a> <a href="/tags/网络/" style="font-size: 15px;">网络</a> <a href="/tags/测试/" style="font-size: 15px;">测试</a> <a href="/tags/Binder/" style="font-size: 15px;">Binder</a> <a href="/tags/Groovy/" style="font-size: 15px;">Groovy</a> <a href="/tags/Loader/" style="font-size: 15px;">Loader</a> <a href="/tags/RAC/" style="font-size: 15px;">RAC</a> <a href="/tags/事件处理/" style="font-size: 15px;">事件处理</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/AIDL-原理分析/">AIDL 原理分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/30/App-启动过程/">App 启动过程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/PMS-解析/">PMS 解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/WMS-解析/">WindowManagerService 解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/29/AMS-解析/">AMS 解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/The-Good-Wife/">The-Good-Wife</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/Black-Sails/">黑帆</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/29/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/23/XCode-8-2-1-ClangFormat-插件安装/">XCode 8.2.1 ClangFormat 插件安装</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/07/SourceTree-分支图谱/">SourceTree 分支图谱</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">蜗牛壳.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>